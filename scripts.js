class AminaCasino{constructor(){this.b={HC:this.getHC(),AMINA:0};this.c='HC';this.w=this.getW();this.t=this.getT();this.p=null;this.aid=1107424865;this.cw='UX3PHCY7QNGOHXWNWTZIXK5T3MBDZKYCFN7PAVCT2H4G4JEZKJK6W7UG44';this.cc=0;this.dp=!1;this.ds=0;this.sq=[];this.ls=0;this.sil=!1;this.g={s:{syms:['⭐','🌟','💫','🌌','🪐','🌙','☄️','🚀','👽','🛸'],sct:'🌠',grid:[],spin:0,win:0,mult:1,spins:0,state:null},p:{balls:[],max:5},bj:{pH:[],dH:[],deck:[],act:0,bet:0,dbl:0,spl:0,ins:0,spH:[],cDbl:0,cSpl:0},h:{card:null,strk:0,bet:0,act:0},d:{bet:null,v1:1,v2:1,roll:0,hot:[]}};this.m={on:0,aud:null};this.hap=navigator.vibrate||navigator.webkitVibrate;this.fx={stars:[],meteors:[]};this.silkyRestore();this.initP();this.init();this.epicCheck();}vib(p=50){if(this.hap&&'ontouchstart'in window)try{this.hap.call(navigator,p)}catch(e){}}load(el,tx='Loading...',glow=!1){if(!el)return;const glowClass=glow?' epic-glow':'';el.innerHTML=`<div class="epic-loading${glowClass}" style="display:flex;align-items:center;gap:8px"><div class="cosmic-spinner"></div>${tx}</div>`;el.disabled=1}unload(el,tx){if(!el)return;el.innerHTML=tx;el.disabled=0;el.classList.add('button-pop');setTimeout(()=>el.classList.remove('button-pop'),200)}epicAnim(){const b=$('balanceAmount');if(b){b.classList.add('balance-pulse');setTimeout(()=>b.classList.remove('balance-pulse'),600)}}getHC(){const d=new Date().toDateString(),s=localStorage.getItem('hc_data');if(s){const dt=JSON.parse(s);if(dt.date===d)return dt.balance}localStorage.setItem('hc_data',JSON.stringify({date:d,balance:1000}));return 1000}saveHC(){localStorage.setItem('hc_data',JSON.stringify({date:new Date().toDateString(),balance:this.b.HC}))}getT(){return localStorage.getItem('session_token')||null}saveT(t){localStorage.setItem('session_token',t);this.t=t}clearT(){localStorage.removeItem('session_token');this.t=null}getW(){const s=localStorage.getItem('connected_wallet')||sessionStorage.getItem('connected_wallet');return s?JSON.parse(s):null}saveW(){['localStorage','sessionStorage'].forEach(s=>window[s].setItem('connected_wallet',JSON.stringify(this.w)));if(this.b.AMINA>0)['localStorage','sessionStorage'].forEach(s=>window[s].setItem('cached_amina_balance',this.b.AMINA.toString()));this.saveApp()}clearW(){['connected_wallet','cached_amina_balance','app_state'].forEach(k=>['localStorage','sessionStorage'].forEach(s=>window[s].removeItem(k)))}saveApp(){const st={inCasino:!$('welcomeScreen').classList.contains('active'),currency:this.c,timestamp:Date.now()};['localStorage','sessionStorage'].forEach(s=>window[s].setItem('app_state',JSON.stringify(st)))}saveGameState(){localStorage.setItem('game_state',JSON.stringify({slots:this.g.s.state,hilo:this.g.h.act?this.g.h:null,timestamp:Date.now()}))}loadGameState(){const gs=localStorage.getItem('game_state');if(gs){const state=JSON.parse(gs);if(Date.now()-state.timestamp<3e5){if(state.slots&&this.g.s.spins>0)this.g.s.state=state.slots;if(state.hilo&&state.hilo.act)this.g.h=state.hilo}}}silkyRestore(){this.sil=!0;const ch=localStorage.getItem('cached_amina_balance')||sessionStorage.getItem('cached_amina_balance');if(ch&&this.w)this.b.AMINA=parseFloat(ch);if(this.w){this.c='AMINA';this.epicUpdCur();this.updBets();this.updDisp()}else{this.c='HC';this.epicUpdCur();this.updBets();this.updDisp()}this.sil=!1}async epicCheck(){if(this.dp)return;if(this.w){const tg=$('currencyToggle');if(tg){tg.classList.add('wallet-connected');setTimeout(()=>tg.classList.remove('wallet-connected'),1e3)}this.updWal();const ap=localStorage.getItem('app_state')||sessionStorage.getItem('app_state');if(ap){const st=JSON.parse(ap);if(st.inCasino&&st.timestamp>Date.now()-3e5)setTimeout(()=>this.enter(),100)}this.loadGameState();this.silkySync();setTimeout(()=>this.refWal(),300);this.processSyncQueue()}}epicUpdCur(){const tg=$('currencyToggle'),tx=tg?.querySelector('.currency-text');if(this.c==='AMINA'){tg?.classList.add('amina');if(tx){tx.textContent='AMINA';tx.classList.add('currency-shine');setTimeout(()=>tx.classList.remove('currency-shine'),800)}}else{tg?.classList.remove('amina');if(tx){tx.textContent='HC';tx.classList.add('currency-shine');setTimeout(()=>tx.classList.remove('currency-shine'),800)}}}async refWal(){if(!this.w)return;try{const bal=await this.fetchAmina(this.w);this.b.AMINA=bal;['localStorage','sessionStorage'].forEach(s=>window[s].setItem('cached_amina_balance',bal.toString()));this.updCash();this.epicAnim()}catch(e){}}async refSess(){if(!this.w)return!1;try{this.clearT();const res=await this.callSess('create_session',{wallet:this.w});if(res.success){this.saveT(res.token);this.cc=res.balance||0;this.updDisp();this.updCash();return!0}}catch(e){}return!1}async callSess(act,data){try{const res=await fetch('/.netlify/functions/session-manager',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:act,...data})});return await res.json()}catch(e){return{success:!1,error:e.message}}}async silkySync(){if(this.dp||(!this.w&&!this.t))return;try{const body=this.t?{action:'get_balance',token:this.t}:{action:'get_balance',wallet:this.w},res=await fetch('/.netlify/functions/casino-credits',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)}),result=await res.json();if(result.success){this.cc=result.balance||0;if(result.token&&!this.t)this.saveT(result.token);if(this.w&&this.cc>=0.001&&this.c==='HC'){this.silentForceAMINA()}this.updDisp();this.updCash();this.ls=Date.now()}else if(result.needsRefresh&&this.w)await this.refSess()}catch(e){if(this.w&&!this.t&&!this.dp)await this.refSess()}}async updServ(act,amt){if(!this.t)return!1;const req={action:act,token:this.t,amount:amt,timestamp:Date.now()};try{const res=await fetch('/.netlify/functions/casino-credits',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(req)}),result=await res.json();if(result.success){this.cc=result.newBalance||result.balance||0;this.updDisp();this.updCash();this.ls=Date.now();return!0}else{this.sq.push(req);return!1}}catch(e){this.sq.push(req);return!1}}async processSyncQueue(){if(this.sq.length===0||!this.t)return;const req=this.sq.shift();try{const res=await fetch('/.netlify/functions/casino-credits',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(req)}),result=await res.json();if(result.success){this.cc=result.newBalance||result.balance||0;this.updDisp();this.updCash();this.ls=Date.now();if(this.sq.length>0)setTimeout(()=>this.processSyncQueue(),100)}else this.sq.unshift(req)}catch(e){this.sq.unshift(req)}setTimeout(()=>this.processSyncQueue(),5e3)}async fetchAmina(wal){try{const res=await fetch(`https://mainnet-idx.algonode.cloud/v2/accounts/${wal}/assets`),data=await res.json(),asset=data.assets?.find(a=>a['asset-id']===this.aid),bal=asset?asset.amount/1e8:0;['localStorage','sessionStorage'].forEach(s=>window[s].setItem('cached_amina_balance',bal.toString()));return bal}catch(e){if(!this.sil)this.notify('❌ Error fetching balance');const ch=localStorage.getItem('cached_amina_balance')||sessionStorage.getItem('cached_amina_balance');return ch?parseFloat(ch):0}}initP(){try{if(typeof PeraWalletConnect!=='undefined'){this.p=new PeraWalletConnect({shouldShowSignTxnToast:!1,chainId:416001});if(typeof this.p.connect==='function'&&typeof this.p.signTransaction==='function')this.p.connector?.on('disconnect',()=>{this.handleWalletDisconnect()});else this.p=null}else this.p=null}catch(e){this.p=null}}handleWalletDisconnect(){this.w=null;this.b.AMINA=0;this.clearW();this.clearT();if(this.g.h.act)this.autoCashHilo();this.forceHC();this.updWal();this.notify('🔓 Wallet disconnected - switched to HC mode');this.createBurst(5)}init(){this.setupUI();this.setupGames();this.setupMusic();this.createCosmicFX();this.updDisp()}setupUI(){$('enterCasino').onclick=()=>{this.vib(50);this.createStarBurst();this.enter()};$('walletBtn').onclick=()=>{this.vib(75);this.togWal()};$('currencyToggle').onclick=()=>{this.vib(25);this.togCur()};this.setupOrb();$$('.game-card').forEach(c=>c.onclick=()=>{this.vib(50);this.createRipple(c);this.switch(c.dataset.game)})}setupOrb(){const orb=$('cosmicOrb'),menu=$('orbitalMenu');let open=0;orb.onclick=()=>{this.vib(75);open=!open;menu.classList.toggle('open',open);orb.style.transform=open?'scale(0.9)':'scale(1)';if(open)this.createBurst(3)};$$('.orbital-item').forEach(i=>i.onclick=()=>{this.vib(50);this.createSparkle(i);this.switch(i.dataset.game);open=0;menu.classList.remove('open');orb.style.transform='scale(1)'});document.addEventListener('click',e=>{if(!e.target.closest('.cosmic-orb-menu')&&open){open=0;menu.classList.remove('open');orb.style.transform='scale(1)'}})}enter(){const btn=$('enterCasino');this.load(btn,'Entering...',!0);setTimeout(()=>{$('welcomeScreen').classList.remove('active');$('mainCasino').classList.add('active');this.saveApp();if(this.w){this.fetchAmina(this.w).then(bal=>{this.b.AMINA=bal;this.updCash()});this.silkySync()}if(this.m.aud&&!this.m.on)this.m.aud.play().then(()=>{this.m.on=1;$('musicToggle').innerHTML='🎵'}).catch(()=>{});this.unload(btn,'ENTER CASINO');this.createBurst(8)},800)}

async togWal(){if(this.w){try{if(this.p&&typeof this.p.disconnect==='function')await this.p.disconnect();else this.handleWalletDisconnect()}catch(e){this.handleWalletDisconnect()}this.notify('🔓 Wallet disconnected');this.vib(100)}else{const btn=$('walletBtn');this.load(btn,'Connecting...',!0);if(!this.p){this.unload(btn,'🔗 Connect Wallet');this.notify('⚠️ Pera Wallet not available - using manual entry');const addr=prompt('Enter Algorand wallet:');if(addr&&addr.length===58){this.w=addr;this.saveW();this.b.AMINA=await this.fetchAmina(addr);await this.refSess();this.epicForceAMINA();this.updWal();this.notify('✅ Wallet connected manually');this.vib([50,100,50]);this.createStarBurst();if($('welcomeScreen').classList.contains('active'))setTimeout(()=>this.enter(),1e3)}else if(addr)this.notify('❌ Invalid address');return}try{const re=await this.p.reconnectSession();if(re&&re.length>0){this.w=re[0];this.saveW();this.b.AMINA=await this.fetchAmina(this.w);await this.refSess();this.epicForceAMINA();this.updWal();this.unload(btn,'🔗 Connect Wallet');this.notify('🚀 Pera Wallet reconnected!');this.vib([50,100,50]);this.createStarBurst();if($('welcomeScreen').classList.contains('active'))setTimeout(()=>this.enter(),1e3);return}const acc=await this.p.connect();if(acc&&acc.length>0){this.w=acc[0];this.saveW();this.b.AMINA=await this.fetchAmina(this.w);await this.refSess();this.epicForceAMINA();this.updWal();this.unload(btn,'🔗 Connect Wallet');this.notify('🚀 Pera Wallet connected!');this.vib([50,100,50]);this.createStarBurst();if($('welcomeScreen').classList.contains('active'))setTimeout(()=>this.enter(),1e3)}else{this.unload(btn,'🔗 Connect Wallet');this.notify('❌ No accounts found')}}catch(e){this.unload(btn,'🔗 Connect Wallet');this.notify(e.type===4001||e.message?.includes('cancelled')?'❌ Connection cancelled':e.message?.includes('rejected')?'❌ Connection rejected':'❌ Connection failed - check Pera Wallet app')}}}forceHC(){this.c='HC';this.epicUpdCur();this.epicUpdBets();this.updDisp();this.saveApp();this.createRippleEffect('HC')}epicForceAMINA(){if(this.w&&this.cc<0.001){if(!this.sil)this.notify('❌ Need at least 0.001 AMINA to switch. Visit Cashier!');this.forceHC();return!1}if(!this.w){this.forceHC();return!1}this.c='AMINA';this.epicUpdCur();this.epicUpdBets();this.updDisp();this.saveApp();this.createRippleEffect('AMINA');return!0}silentForceAMINA(){if(this.w&&this.cc>=0.001&&this.c==='HC'){this.c='AMINA';this.epicUpdCur();this.epicUpdBets();this.updDisp();this.saveApp();this.createGentleGlow()}}updWal(){const btn=$('walletBtn');if(this.w){btn.innerHTML='🔓 '+this.w.slice(0,4)+'...'+this.w.slice(-4);btn.classList.add('wallet-connected');setTimeout(()=>btn.classList.remove('wallet-connected'),2e3)}else{btn.innerHTML='🔗 Connect Wallet';btn.classList.remove('wallet-connected')}}async togCur(){if(!this.w){this.notify('🔗 Connect wallet for AMINA!');this.vib(100);this.createWarningPulse();return}const btn=$('currencyToggle');btn.classList.add('toggle-active');setTimeout(()=>btn.classList.remove('toggle-active'),300);if(this.c==='HC'){if(this.epicForceAMINA()){this.notify('🪙 Switched to AMINA mode');this.createCurrencyWave('AMINA')}}else{this.forceHC();this.notify('🏠 Switched to HC mode');this.createCurrencyWave('HC')}this.vib(50)}epicUpdBets(){const bets=this.c==='HC'?['1','5','10']:['0.001','0.005','0.01'];['slots','plinko','blackjack','hilo','dice'].forEach(g=>{const sel=$(`${g}Bet`);if(sel){const oldVal=sel.value;sel.innerHTML='';bets.forEach(b=>{const opt=document.createElement('option');opt.value=opt.textContent=b;sel.appendChild(opt)});sel.value=bets.includes(oldVal)?oldVal:bets[0];sel.classList.add('bet-update');setTimeout(()=>sel.classList.remove('bet-update'),400)}})}updDisp(){const bal=this.c==='AMINA'?this.cc:this.b.HC;const balEl=$('balanceAmount');balEl.textContent=this.c==='AMINA'?this.trimZeros(bal.toFixed(8)):bal.toFixed(0);$('currencySymbol').textContent=this.c;this.epicAnim();['slots','plinko','blackjack','hilo','dice'].forEach(g=>{const el=$(`${g}Currency`);if(el){el.textContent=this.c;el.classList.add('currency-pop');setTimeout(()=>el.classList.remove('currency-pop'),300)}})}trimZeros(str){return str.replace(/\.?0+$/,'')}async valBal(){if(this.c==='AMINA'&&this.cc<0.001){if(!this.sil){this.notify('💰 Please top up your AMINA balance!');this.createWarningPulse()}this.forceHC();return!1}return!0}async deduct(amt){if(!await this.valBal())return 0;if(this.c==='AMINA'){if(this.cc<amt){this.notify('❌ Insufficient AMINA credits! Visit Cashier.');this.vib(100);this.createErrorShake();return 0}this.cc-=amt;this.updDisp();const suc=await this.updServ('deduct_credits',amt);if(!suc&&!this.sil)this.notify('⏸️ Sync pending...');this.createSpendEffect(amt);return 1}else{if(this.b.HC<amt){this.notify('❌ Insufficient HC balance!');this.vib(100);this.createErrorShake();return 0}this.b.HC-=amt;this.saveHC();this.updDisp();this.createSpendEffect(amt);return 1}}async add(amt,src='win'){if(this.c==='AMINA'&&src==='win'){this.cc+=amt;this.updDisp();const suc=await this.updServ('add_credits',amt);if(!suc&&!this.sil)this.notify('⏸️ Sync pending...');this.vib([25,50,25]);this.createWinEffect(amt)}else{this.b.HC+=amt;this.saveHC();this.updDisp();this.vib([25,50,25]);this.createWinEffect(amt)}}switch(id){this.vib(25);$$('.game-screen').forEach(s=>{s.classList.remove('active');s.classList.add('game-exit')});setTimeout(()=>{$$('.game-screen').forEach(s=>s.classList.remove('game-exit'));$(id).classList.add('active','game-enter');setTimeout(()=>$(id).classList.remove('game-enter'),500)},200);const games={slots:()=>this.initSlots(),plinko:()=>this.initPlinko(),blackjack:()=>this.initBJ(),hilo:()=>this.initHilo(),dice:()=>this.initDice(),cashier:()=>this.initCash()};if(games[id])setTimeout(()=>games[id](),250)}notify(msg,type='info'){const div=document.createElement('div');div.textContent=msg;div.style.cssText=`position:fixed;top:20px;right:20px;z-index:1001;background:${type==='error'?'#F44336':'#FFD700'};color:#000;padding:1rem 2rem;border-radius:15px;font-family:JetBrains Mono,monospace;font-weight:700;transform:translateX(100%);transition:all .4s cubic-bezier(0.68,-0.55,0.265,1.55);max-width:300px;word-wrap:break-word;box-shadow:0 8px 25px rgba(0,0,0,0.3);border:2px solid ${type==='error'?'#D32F2F':'#FFA000'}`;document.body.appendChild(div);setTimeout(()=>{div.style.transform='translateX(0)';div.style.boxShadow='0 15px 35px rgba(0,0,0,0.4)'},50);setTimeout(()=>{div.style.transform='translateX(100%)';div.style.opacity='0';setTimeout(()=>div.remove(),400)},3500)}showRes(game,msg,type='info'){const el=$(`${game}Result`);if(el){el.textContent=msg;el.className=`game-result show ${type}`;if(type==='win'&&msg.includes('MEGA')){el.classList.add('mega-win');this.vib([100,50,100,50,100]);this.createMegaWinExplosion()}else if(type==='win'){this.vib([50,25,50]);this.createWinBurst()}setTimeout(()=>el.classList.remove('show','mega-win'),5e3)}}createStarBurst(){for(let i=0;i<8;i++){const star=document.createElement('div');star.className='star-burst';star.style.cssText=`position:fixed;top:50%;left:50%;width:4px;height:4px;background:#FFD700;border-radius:50%;pointer-events:none;z-index:1000;transform:translate(-50%,-50%) rotate(${i*45}deg) translateY(-${20+Math.random()*30}px);opacity:1;transition:all 0.8s ease-out`;document.body.appendChild(star);setTimeout(()=>{star.style.transform+=` translateY(-${100+Math.random()*50}px) scale(0)`;star.style.opacity='0';setTimeout(()=>star.remove(),800)},50)}}createBurst(count){for(let i=0;i<count;i++){setTimeout(()=>{const burst=document.createElement('div');burst.className='cosmic-burst';burst.style.cssText=`position:fixed;top:${Math.random()*100}%;left:${Math.random()*100}%;width:3px;height:3px;background:hsl(${Math.random()*360},70%,60%);border-radius:50%;pointer-events:none;z-index:999;opacity:1;transition:all 1s ease-out`;document.body.appendChild(burst);setTimeout(()=>{burst.style.transform=`scale(${2+Math.random()*3}) translateY(-${50+Math.random()*100}px)`;burst.style.opacity='0';setTimeout(()=>burst.remove(),1e3)},100)},i*100)}}createRipple(el){const rect=el.getBoundingClientRect();const ripple=document.createElement('div');ripple.style.cssText=`position:fixed;top:${rect.top+rect.height/2}px;left:${rect.left+rect.width/2}px;width:0;height:0;border-radius:50%;background:rgba(255,215,0,0.3);pointer-events:none;z-index:1000;transition:all 0.6s ease-out;transform:translate(-50%,-50%)`;document.body.appendChild(ripple);setTimeout(()=>{ripple.style.width='100px';ripple.style.height='100px';ripple.style.opacity='0';setTimeout(()=>ripple.remove(),600)},10)}createSparkle(el){const rect=el.getBoundingClientRect();for(let i=0;i<3;i++){const sparkle=document.createElement('div');sparkle.style.cssText=`position:fixed;top:${rect.top+Math.random()*rect.height}px;left:${rect.left+Math.random()*rect.width}px;width:2px;height:2px;background:#FFD700;border-radius:50%;pointer-events:none;z-index:1001;opacity:1;transition:all 0.8s ease-out`;document.body.appendChild(sparkle);setTimeout(()=>{sparkle.style.transform=`translateY(-${30+Math.random()*20}px) scale(0)`;sparkle.style.opacity='0';setTimeout(()=>sparkle.remove(),800)},i*100)}}createRippleEffect(type){const color=type==='AMINA'?'255,20,147':'0,229,255';const ripple=document.createElement('div');ripple.style.cssText=`position:fixed;top:50%;left:50%;width:0;height:0;border-radius:50%;background:rgba(${color},0.2);border:2px solid rgba(${color},0.8);pointer-events:none;z-index:1000;transition:all 0.8s ease-out;transform:translate(-50%,-50%)`;document.body.appendChild(ripple);setTimeout(()=>{ripple.style.width='200px';ripple.style.height='200px';ripple.style.opacity='0';setTimeout(()=>ripple.remove(),800)},10)}createCurrencyWave(type){const wave=document.createElement('div');wave.style.cssText=`position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(${type==='AMINA'?'255,20,147':'0,229,255'},0.1),transparent);pointer-events:none;z-index:999;opacity:0;transition:all 0.6s ease;transform:translateX(-100%)`;document.body.appendChild(wave);setTimeout(()=>{wave.style.opacity='1';wave.style.transform='translateX(100%)';setTimeout(()=>wave.remove(),600)},10)}createGentleGlow(){const glow=document.createElement('div');glow.style.cssText=`position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle,rgba(255,215,0,0.05),transparent 70%);pointer-events:none;z-index:998;opacity:0;transition:opacity 1s ease`;document.body.appendChild(glow);setTimeout(()=>{glow.style.opacity='1';setTimeout(()=>{glow.style.opacity='0';setTimeout(()=>glow.remove(),1e3)},1e3)},10)}createWarningPulse(){const pulse=document.createElement('div');pulse.style.cssText=`position:fixed;top:50%;left:50%;width:50px;height:50px;border:3px solid #F44336;border-radius:50%;pointer-events:none;z-index:1000;opacity:1;transition:all 0.8s ease-out;transform:translate(-50%,-50%)`;document.body.appendChild(pulse);setTimeout(()=>{pulse.style.width='150px';pulse.style.height='150px';pulse.style.opacity='0';setTimeout(()=>pulse.remove(),800)},10)}createErrorShake(){const el=$('balanceAmount');if(el){el.classList.add('error-shake');setTimeout(()=>el.classList.remove('error-shake'),600)}}createSpendEffect(amt){const spend=document.createElement('div');spend.textContent=`-${this.trimZeros(amt.toFixed(this.c==='AMINA'?8:0))} ${this.c}`;spend.style.cssText=`position:fixed;top:30%;right:20%;color:#F44336;font-family:JetBrains Mono,monospace;font-weight:700;font-size:1.2rem;pointer-events:none;z-index:1001;opacity:1;transition:all 1s ease-out`;document.body.appendChild(spend);setTimeout(()=>{spend.style.transform='translateY(-50px)';spend.style.opacity='0';setTimeout(()=>spend.remove(),1e3)},100)}createWinEffect(amt){const win=document.createElement('div');win.textContent=`+${this.trimZeros(amt.toFixed(this.c==='AMINA'?8:0))} ${this.c}`;win.style.cssText=`position:fixed;top:30%;right:20%;color:#4CAF50;font-family:JetBrains Mono,monospace;font-weight:700;font-size:1.4rem;pointer-events:none;z-index:1001;opacity:1;transition:all 1s ease-out;text-shadow:0 0 10px #4CAF50`;document.body.appendChild(win);setTimeout(()=>{win.style.transform='translateY(-50px) scale(1.2)';win.style.opacity='0';setTimeout(()=>win.remove(),1e3)},100)}createWinBurst(){this.createBurst(5)}createMegaWinExplosion(){this.createBurst(15);this.createStarBurst()}setupGames(){}setupMusic(){const btn=$('musicToggle');this.m.aud=document.createElement('audio');Object.assign(this.m.aud,{loop:1,volume:.3,src:'https://dn721902.ca.archive.org/0/items/tvtunes_26876/Hot%20Butter%20Popcorn.mp3',crossOrigin:'anonymous'});this.m.on=1;this.m.aud.play().catch(()=>{this.m.on=0;btn.innerHTML='🔇'});btn.onclick=()=>{this.vib(25);btn.classList.add('button-pop');setTimeout(()=>btn.classList.remove('button-pop'),200);if(this.m.on){this.m.aud.pause();btn.innerHTML='🔇';this.m.on=0;this.notify('🎵 Music off')}else{this.m.aud.play().catch(()=>this.notify('❌ Music failed to load'));btn.innerHTML='🎵';this.m.on=1;this.notify('🎵 Hot Butter Popcorn!')}}}createCosmicFX(){this.starField();setInterval(()=>{if(Math.random()<.4)this.createCosmicPart()},2e3)}starField(){for(let i=0;i<20;i++){setTimeout(()=>{const star=document.createElement('div');star.style.cssText=`position:fixed;width:2px;height:2px;background:#FFD700;border-radius:50%;pointer-events:none;z-index:-1;top:${Math.random()*100}%;left:${Math.random()*100}%;opacity:${Math.random()*.5+.2};animation:twinkle ${2+Math.random()*3}s ease-in-out infinite`;document.body.appendChild(star);setTimeout(()=>star.remove(),1e4)},i*200)}}createCosmicPart(){const el=document.createElement('div'),syms=['✨','⭐','🌟','💫','🌙','☄️'];el.textContent=syms[Math.floor(Math.random()*6)];el.style.cssText=`position:fixed;font-size:${Math.random()*12+10}px;pointer-events:none;z-index:-1;left:${Math.random()*100}%;top:100vh;opacity:${Math.random()*.8+.2};animation:floatUp ${Math.random()*6+4}s linear forwards`;document.body.appendChild(el);setTimeout(()=>el.remove(),1e4)}

async refAmin(){if(!this.w)return;this.notify(`💰 Manual wallet mode - balance: ${this.b.AMINA.toFixed(8)} AMINA`);this.updDisp()}initCash(){this.epicUpdCash();if(this.w)this.refWal().then(()=>{}).catch(e=>{});const depositBtn=$('depositBtn'),withdrawBtn=$('withdrawBtn');depositBtn.onclick=()=>{this.vib(50);depositBtn.classList.add('button-press');setTimeout(()=>depositBtn.classList.remove('button-press'),200);this.depAmina()};withdrawBtn.onclick=()=>{this.vib(50);withdrawBtn.classList.add('button-press');setTimeout(()=>withdrawBtn.classList.remove('button-press'),200);this.withAmina()};this.updTrans()}epicUpdCash(){const walletBal=$('walletBalance'),casinoBal=$('casinoCredits');if(walletBal){walletBal.textContent=`${this.trimZeros(this.b.AMINA.toFixed(8))} AMINA`;walletBal.classList.add('balance-update');setTimeout(()=>walletBal.classList.remove('balance-update'),500)}if(casinoBal){casinoBal.textContent=`${this.trimZeros(this.cc.toFixed(8))} AMINA`;casinoBal.classList.add('balance-update');setTimeout(()=>casinoBal.classList.remove('balance-update'),500)}}updCash(){this.epicUpdCash()}async depAmina(){if(!this.w){this.notify('🔗 Connect wallet first!');this.createWarningPulse();return}if(this.dp){this.notify('⏸️ Deposit already in progress...');return}const amt=parseFloat($('depositAmount').value);if(!amt||amt<=0){this.notify('❌ Enter valid amount');this.createErrorShake();return}if(amt>this.b.AMINA){this.notify('❌ Insufficient AMINA balance');this.createErrorShake();return}this.dp=!0;this.ds=Date.now();this.notify('📝 Manual wallet detected - preparing transaction...');this.createSparkleEffect();this.showManTx({amount:amt,from:this.w,to:this.cw,note:`AMINA Casino Deposit: ${amt}`,assetId:this.aid})}showManTx(tx){const modal=document.createElement('div');modal.id='depositModal';modal.style.cssText='position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.95);backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:center;z-index:10000;padding:5px;box-sizing:border-box;opacity:0;transition:opacity 0.3s ease';modal.innerHTML=`<div class="epic-modal" style="background:linear-gradient(135deg,#1a2332,#2a3441);border-radius:20px;padding:20px;width:95%;max-width:380px;max-height:85vh;overflow-y:auto;border:3px solid #ffd700;color:white;font-family:JetBrains Mono,monospace;font-size:12px;box-shadow:0 25px 50px rgba(0,0,0,0.8);transform:scale(0.8);transition:transform 0.3s ease"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px"><h3 style="margin:0;color:#ffd700;font-size:16px;text-shadow:0 0 10px #ffd700">📝 Manual Signing</h3><button onclick="casino.closeDep()" class="epic-close" style="background:none;border:none;color:#ffd700;font-size:20px;cursor:pointer;width:30px;height:30px;border-radius:50%;transition:all 0.3s ease" onmouseover="this.style.background='rgba(255,215,0,0.2)'" onmouseout="this.style.background='none'">&times;</button></div><div style="background:linear-gradient(135deg,#2a3441,#1a2332);padding:12px;border-radius:10px;margin-bottom:15px;font-size:11px;border:1px solid #ffd70033"><div><strong>Amount:</strong> <span style="color:#ffd700">${tx.amount} AMINA</span></div><div><strong>To:</strong> <span style="color:#00e5ff">Casino</span></div><div><strong>Asset:</strong> <span style="color:#e91e63">${tx.assetId}</span></div></div><div style="margin-bottom:15px"><h4 style="color:#ffd700;font-size:13px;margin:10px 0 6px;text-shadow:0 0 5px #ffd700">📱 Send Manually</h4><p style="font-size:11px;margin:6px 0;color:#ccc">Send exactly <strong style="color:#ffd700">${tx.amount} AMINA</strong> to:</p><input readonly onclick="this.select()" value="${this.cw}" class="epic-input" style="width:100%;background:#1a2332;color:#ffd700;border:2px solid #ffd700;border-radius:8px;padding:8px;font-size:10px;box-sizing:border-box;margin:4px 0;transition:all 0.3s ease;font-family:JetBrains Mono,monospace" onfocus="this.style.boxShadow='0 0 15px rgba(255,215,0,0.5)'" onblur="this.style.boxShadow='none'"><button onclick="navigator.clipboard.writeText('${this.cw}');this.style.background='#4caf50';this.textContent='✅ Copied!';setTimeout(()=>{this.style.background='#ffd700';this.textContent='📋 Copy Address'},1000)" class="epic-copy-btn" style="background:#ffd700;color:#000;border:none;padding:10px 15px;border-radius:8px;margin:6px 0;cursor:pointer;font-size:11px;width:100%;font-weight:700;transition:all 0.3s ease;box-shadow:0 4px 15px rgba(255,215,0,0.3)" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">📋 Copy Address</button></div><div style="display:flex;gap:10px;margin-top:15px"><button onclick="casino.compDep(${tx.amount})" class="epic-confirm-btn" style="background:linear-gradient(135deg,#4caf50,#45a049);color:white;border:none;padding:12px 15px;border-radius:8px;cursor:pointer;font-size:11px;flex:1;font-weight:700;transition:all 0.3s ease;box-shadow:0 4px 15px rgba(76,175,80,0.3)" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">✅ I Sent It</button><button onclick="casino.closeDep()" class="epic-cancel-btn" style="background:linear-gradient(135deg,#f44336,#d32f2f);color:white;border:none;padding:12px 15px;border-radius:8px;cursor:pointer;font-size:11px;flex:1;font-weight:700;transition:all 0.3s ease;box-shadow:0 4px 15px rgba(244,67,54,0.3)" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">❌ Cancel</button></div></div>`;document.body.appendChild(modal);setTimeout(()=>{modal.style.opacity='1';modal.querySelector('.epic-modal').style.transform='scale(1)'},10)}closeDep(){const modal=$('depositModal');if(modal){modal.style.opacity='0';modal.querySelector('.epic-modal').style.transform='scale(0.8)';setTimeout(()=>modal.remove(),300)}this.dp=!1;this.ds=0}compDep(amt){this.closeDep();this.detDep(amt)}async detDep(amt){if(!this.w){this.notify('❌ Wallet required for deposits');return}this.notify('🔍 Advanced detection starting...');let att=0;const max=20,poll=12e3,det=async()=>{att++;try{const res=await fetch('/.netlify/functions/monitor-deposits',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({wallet:this.w,amount:amt,timestamp:this.ds})}),result=await res.json();if(result.success&&result.processed>0){this.dp=!1;this.ds=0;await this.silkySync();this.notify(`✅ Deposit confirmed! ${this.trimZeros(amt.toFixed(8))} AMINA credited!`);this.addTrans('deposit',amt);$('depositAmount').value='';this.vib([100,50,100]);this.createDepositSuccess();return}this.notify(`🔍 Checking blockchain... (${att}/${max})`);if(att<max)setTimeout(det,poll);else{this.dp=!1;this.ds=0;this.notify('⏰ Detection timeout. Contact support if AMINA was sent.')}}catch(e){if(att<max){this.notify(`🔄 Detection error, retrying... (${att}/${max})`);setTimeout(det,poll)}else{this.dp=!1;this.ds=0;this.notify('❌ Detection failed. Contact support if AMINA was sent.')}}};det()}async withAmina(){if(!this.w){this.notify('🔗 Connect wallet first!');this.createWarningPulse();return}const amt=parseFloat($('withdrawAmount').value);if(!amt||amt<=0){this.notify('❌ Enter valid amount');this.createErrorShake();return}if(amt>this.cc){this.notify('❌ Insufficient casino credits');this.createErrorShake();return}this.notify('🔄 Processing automated withdrawal...');this.createWithdrawEffect();try{const res=await fetch('/.netlify/functions/casino-withdraw',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({amount:amt,toAddress:this.w,wallet:this.w})}),result=await res.json();if(result.success){this.cc-=amt;this.updDisp();this.epicUpdCash();const suc=await this.updServ('deduct_credits',amt);if(!suc&&!this.sil)this.notify('⏸️ Sync pending...');this.addTrans('withdrawal',amt);this.notify(`✅ Withdrawal complete! ${this.trimZeros(amt.toFixed(8))} AMINA sent! TX: ${result.txId.slice(0,8)}...`);$('withdrawAmount').value='';this.vib([100,50,100]);this.createWithdrawSuccess()}else this.notify(result.refund?`❌ ${result.error} - Credits remain in account`:`❌ ${result.error}`)}catch(e){this.notify('❌ Network error - please try again')}}addTrans(type,amt){const trans=JSON.parse(localStorage.getItem('transactions')||'[]'),tx={id:Date.now(),type,amount:amt,timestamp:new Date().toISOString(),status:'completed'};trans.unshift(tx);trans.splice(10);localStorage.setItem('transactions',JSON.stringify(trans));this.updTrans()}updTrans(){const list=$('transactionList');if(!list)return;const trans=JSON.parse(localStorage.getItem('transactions')||'[]');list.innerHTML=trans.length===0?'<div class="transaction-placeholder" style="opacity:0;animation:fadeIn 0.5s ease forwards">No transactions yet. Make your first deposit!</div>':trans.map((tx,i)=>`<div class="transaction-item epic-transaction" style="opacity:0;animation:slideInTransaction 0.5s ease forwards;animation-delay:${i*0.1}s"><div class="tx-icon epic-tx-icon">${tx.type==='deposit'?'💰':'💸'}</div><div class="tx-details"><div class="tx-type epic-tx-type">${tx.type==='deposit'?'Deposit':'Withdrawal'}</div><div class="tx-amount epic-tx-amount">${this.trimZeros(tx.amount.toFixed(8))} AMINA</div></div><div class="tx-time epic-tx-time">${new Date(tx.timestamp).toLocaleTimeString()}</div></div>`).join('')}createSparkleEffect(){for(let i=0;i<10;i++){setTimeout(()=>{const sparkle=document.createElement('div');sparkle.style.cssText=`position:fixed;top:${Math.random()*100}%;left:${Math.random()*100}%;width:3px;height:3px;background:#FFD700;border-radius:50%;pointer-events:none;z-index:1001;opacity:1;transition:all 1s ease-out;box-shadow:0 0 10px #FFD700`;document.body.appendChild(sparkle);setTimeout(()=>{sparkle.style.transform=`scale(3) translateY(-${50+Math.random()*50}px)`;sparkle.style.opacity='0';setTimeout(()=>sparkle.remove(),1e3)},100)},i*100)}}createDepositSuccess(){this.createBurst(12);for(let i=0;i<5;i++){setTimeout(()=>{const coin=document.createElement('div');coin.textContent='🪙';coin.style.cssText=`position:fixed;top:20%;left:${30+Math.random()*40}%;font-size:2rem;pointer-events:none;z-index:1001;opacity:1;transition:all 2s ease-out`;document.body.appendChild(coin);setTimeout(()=>{coin.style.transform=`translateY(60vh) rotate(720deg) scale(0.5)`;coin.style.opacity='0';setTimeout(()=>coin.remove(),2e3)},100)},i*200)}}createWithdrawEffect(){const withdraw=document.createElement('div');withdraw.style.cssText=`position:fixed;top:50%;left:50%;width:100px;height:100px;border:3px solid #E91E63;border-radius:50%;pointer-events:none;z-index:1000;opacity:1;transition:all 1s ease-out;transform:translate(-50%,-50%);animation:spin 1s linear infinite`;document.body.appendChild(withdraw);setTimeout(()=>{withdraw.style.width='300px';withdraw.style.height='300px';withdraw.style.opacity='0';setTimeout(()=>withdraw.remove(),1e3)},10)}createWithdrawSuccess(){this.createBurst(8);const success=document.createElement('div');success.textContent='🚀';success.style.cssText=`position:fixed;top:50%;left:50%;font-size:3rem;pointer-events:none;z-index:1001;opacity:1;transition:all 1.5s ease-out;transform:translate(-50%,-50%)`;document.body.appendChild(success);setTimeout(()=>{success.style.transform='translate(-50%,-50%) translateY(-100px) scale(2)';success.style.opacity='0';setTimeout(()=>success.remove(),1500)},100)}async betWithFeedback(amt,game){const betBtn=$(`${game}Bet`).parentElement.querySelector('.cosmic-btn');if(betBtn){betBtn.classList.add('bet-processing');this.load(betBtn,'Betting...',!0)}const result=await this.deduct(amt);if(betBtn){this.unload(betBtn,betBtn.textContent);betBtn.classList.remove('bet-processing')}if(result){this.createBetEffect(amt,game)}return result}createBetEffect(amt,game){const effect=document.createElement('div');effect.textContent=`-${this.trimZeros(amt.toFixed(this.c==='AMINA'?8:0))} ${this.c}`;effect.style.cssText=`position:fixed;top:25%;right:15%;color:#FF6B35;font-family:JetBrains Mono,monospace;font-weight:700;font-size:1.1rem;pointer-events:none;z-index:1001;opacity:1;transition:all 1.2s cubic-bezier(0.25,0.46,0.45,0.94);text-shadow:0 0 10px #FF6B35;border:2px solid #FF6B35;padding:5px 10px;border-radius:8px;background:rgba(255,107,53,0.1)`;document.body.appendChild(effect);setTimeout(()=>{effect.style.transform='translateY(-60px) scale(0.8)';effect.style.opacity='0';setTimeout(()=>effect.remove(),1200)},100)}async winWithCelebration(amt,game,type='normal'){await this.add(amt,'win');this.createWinCelebration(amt,type);if(type==='mega'){this.createMegaWinSpectacle()}else if(type==='big'){this.createBigWinShow()}}createWinCelebration(amt,type='normal'){const colors=['#4CAF50','#FFD700','#00E5FF','#E91E63'];const celebration=document.createElement('div');celebration.textContent=`+${this.trimZeros(amt.toFixed(this.c==='AMINA'?8:0))} ${this.c}`;celebration.style.cssText=`position:fixed;top:25%;right:15%;color:${colors[Math.floor(Math.random()*colors.length)]};font-family:JetBrains Mono,monospace;font-weight:700;font-size:${type==='mega'?'2rem':type==='big'?'1.6rem':'1.3rem'};pointer-events:none;z-index:1001;opacity:1;transition:all 1.5s cubic-bezier(0.175,0.885,0.32,1.275);text-shadow:0 0 15px currentColor;border:3px solid currentColor;padding:8px 15px;border-radius:12px;background:rgba(255,255,255,0.1);backdrop-filter:blur(5px)`;document.body.appendChild(celebration);setTimeout(()=>{celebration.style.transform=`translateY(-80px) scale(${type==='mega'?'1.5':type==='big'?'1.3':'1.1'})`;celebration.style.opacity='0';setTimeout(()=>celebration.remove(),1500)},100)}createBigWinShow(){this.createBurst(20);for(let i=0;i<8;i++){setTimeout(()=>{const firework=document.createElement('div');firework.style.cssText=`position:fixed;top:${20+Math.random()*60}%;left:${10+Math.random()*80}%;width:5px;height:5px;background:hsl(${Math.random()*360},70%,60%);border-radius:50%;pointer-events:none;z-index:1002;opacity:1;transition:all 1.5s ease-out;box-shadow:0 0 20px currentColor`;document.body.appendChild(firework);setTimeout(()=>{firework.style.transform=`scale(8) rotate(360deg)`;firework.style.opacity='0';setTimeout(()=>firework.remove(),1500)},100)},i*150)}}createMegaWinSpectacle(){this.createBurst(40);this.createStarBurst();for(let i=0;i<15;i++){setTimeout(()=>{const spectacular=document.createElement('div');spectacular.textContent=['🌟','⭐','✨','💫','🎆'][Math.floor(Math.random()*5)];spectacular.style.cssText=`position:fixed;top:${Math.random()*100}%;left:${Math.random()*100}%;font-size:${2+Math.random()*2}rem;pointer-events:none;z-index:1003;opacity:1;transition:all 2s ease-out;filter:drop-shadow(0 0 10px gold)`;document.body.appendChild(spectacular);setTimeout(()=>{spectacular.style.transform=`scale(${2+Math.random()}) rotate(${360+Math.random()*360}deg) translateY(-100px)`;spectacular.style.opacity='0';setTimeout(()=>spectacular.remove(),2e3)},100)},i*80)}}enhancedVibration(pattern){if(Array.isArray(pattern)){pattern.forEach((duration,index)=>{setTimeout(()=>this.vib(duration),index*100)})}else{this.vib(pattern)}}gameTransition(fromGame,toGame){if(fromGame){const fromEl=$(fromGame);if(fromEl){fromEl.classList.add('game-fade-out');setTimeout(()=>{fromEl.classList.remove('active','game-fade-out')},300)}}setTimeout(()=>{const toEl=$(toGame);if(toEl){toEl.classList.add('active','game-fade-in');setTimeout(()=>toEl.classList.remove('game-fade-in'),500)}},200)}

initSlots(){this.g.s.grid=Array(5).fill().map(()=>Array(6).fill(''));this.g.s.win=0;this.g.s.mult=1;this.g.s.spins=0;this.g.s.spin=0;this.createEpicGrid();this.fillGrid();if(this.g.s.state&&this.g.s.spins>0){this.g.s.spins=this.g.s.state.spins;this.g.s.mult=this.g.s.state.mult;this.notify('🎰 Free spins resumed! Press SPIN to continue');this.createResumeEffect()}this.updSlots();const spinBtn=$('spinBtn'),bonusBtn=$('buyBonusBtn'),autoBtn=$('autoplayBtn');spinBtn.onclick=()=>{this.enhancedVibration(50);spinBtn.classList.add('spin-press');setTimeout(()=>spinBtn.classList.remove('spin-press'),200);this.epicSpinSlots()};bonusBtn.onclick=()=>{this.enhancedVibration([75,25,75]);bonusBtn.classList.add('bonus-press');setTimeout(()=>bonusBtn.classList.remove('bonus-press'),300);this.epicBuyBonus()};autoBtn.onclick=()=>{autoBtn.classList.add('button-pop');setTimeout(()=>autoBtn.classList.remove('button-pop'),200);this.notify('🔄 Autoplay feature - coming soon!')}}createEpicGrid(){const grid=$('chaosGrid');if(!grid)return;grid.innerHTML='';grid.style.perspective='1000px';for(let i=0;i<30;i++){const sym=document.createElement('div');sym.className='chaos-symbol epic-symbol';sym.id=`chaos-${i}`;sym.style.cssText=`aspect-ratio:1;background:linear-gradient(135deg,rgba(255,255,255,0.1),rgba(255,255,255,0.05));border:2px solid var(--pc);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.8rem;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);cursor:pointer;position:relative;overflow:hidden;min-height:50px;transform-style:preserve-3d`;sym.addEventListener('mouseenter',()=>{sym.style.transform='scale(1.05) rotateY(10deg)';sym.style.borderColor='var(--cg)';sym.style.boxShadow='0 8px 25px rgba(255,215,0,0.3)'});sym.addEventListener('mouseleave',()=>{sym.style.transform='scale(1) rotateY(0deg)';sym.style.borderColor='var(--pc)';sym.style.boxShadow='none'});const shimmer=document.createElement('div');shimmer.style.cssText='position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent,rgba(255,255,255,0.1),transparent);transform:translateX(-100%);transition:transform 0.6s ease;pointer-events:none';sym.appendChild(shimmer);grid.appendChild(sym)}}fillGrid(){const syms=this.g.s.syms;for(let r=0;r<5;r++)for(let c=0;c<6;c++){const newSym=syms[Math.floor(Math.random()*syms.length)];this.g.s.grid[r][c]=newSym;const idx=r*6+c,symEl=$(`chaos-${idx}`);if(symEl){symEl.style.transform='rotateY(180deg)';setTimeout(()=>{symEl.textContent=newSym;symEl.style.transform='rotateY(0deg)'},Math.random()*100)}}}updSlots(){for(let r=0;r<5;r++)for(let c=0;c<6;c++){const idx=r*6+c,sym=$(`chaos-${idx}`);if(sym&&sym.textContent!==this.g.s.grid[r][c]){sym.style.transform='scale(1.1) rotateX(180deg)';setTimeout(()=>{sym.textContent=this.g.s.grid[r][c];sym.style.transform='scale(1) rotateX(0deg)'},50)}}const els=['currentMultiplier','freeSpinsCount','totalWin'],vals=[`${this.g.s.mult}x`,this.g.s.spins,this.trimZeros(this.g.s.win.toFixed(8))];els.forEach((id,i)=>{const el=$(id);if(el){if(el.textContent!==vals[i]){el.style.transform='scale(1.2)';el.style.color='var(--cg)';el.textContent=vals[i];setTimeout(()=>{el.style.transform='scale(1)';el.style.color=''},400)}el.classList.add('stat-update');setTimeout(()=>el.classList.remove('stat-update'),600)}});const winCurrency=$('winCurrency');if(winCurrency){winCurrency.textContent=this.c;winCurrency.classList.add('currency-flash');setTimeout(()=>winCurrency.classList.remove('currency-flash'),300)}}async epicSpinSlots(){if(this.g.s.spin)return;const bet=+$('slotsBet').value,spinBtn=$('spinBtn');if(this.g.s.spins===0){if(!await this.betWithFeedback(bet,'slots'))return}else{this.g.s.spins--;this.createFreeSpinEffect()}this.g.s.spin=1;this.g.s.win=0;this.g.s.state={spins:this.g.s.spins,mult:this.g.s.mult};this.saveGameState();this.load(spinBtn,'SPINNING...',!0);this.createSpinStartEffect();$$('.chaos-symbol').forEach((s,i)=>{setTimeout(()=>{s.classList.add('epic-spinning');s.style.animationDelay=`${i*20}ms`},i*15)});const spinPromise=new Promise(res=>{let sp=0;const int=setInterval(()=>{this.fillGrid();this.updSlots();if(++sp>=30){clearInterval(int);res()}},60)});await spinPromise;$$('.chaos-symbol').forEach((s,i)=>{setTimeout(()=>{s.classList.remove('epic-spinning');s.style.animationDelay='0ms'},i*10)});const clust=this.findClust();let totWin=0,winningPositions=[];clust.forEach(cl=>{const mult=cl.size>=20?500:cl.size>=15?50:cl.size>=10?10:cl.size>=7?5:cl.size>=5?2:1;totWin+=bet*mult*this.g.s.mult;winningPositions.push(...cl.positions);cl.positions.forEach(({row,col})=>{const idx=row*6+col,sym=$(`chaos-${idx}`);if(sym){setTimeout(()=>{sym.classList.add('epic-winning');sym.style.transform='scale(1.3) rotateZ(5deg)';sym.style.background='radial-gradient(circle,rgba(255,215,0,0.3),transparent)';sym.style.borderColor='var(--cg)';sym.style.boxShadow='0 0 20px var(--cg)'},Math.random()*200)}})});let scatterCount=0;for(let r=0;r<5;r++)for(let c=0;c<6;c++)if(this.g.s.grid[r][c]===this.g.s.sct)scatterCount++;if(scatterCount>=3){this.g.s.spins+=10;this.g.s.mult=Math.min(this.g.s.mult+1,10);this.notify(`🌠 ${scatterCount} SCATTERS! +10 Free Spins with ${this.g.s.mult}x multiplier!`);this.enhancedVibration([100,50,100,50,100]);this.createScatterExplosion(scatterCount)}if(Math.random()<.03){const bonusWin=bet*(20+Math.floor(Math.random()*80));totWin+=bonusWin;this.notify('☄️ COSMIC METEOR STRIKE! Bonus win!');this.enhancedVibration([200,100,200]);this.createMeteorStrike()}this.g.s.win=totWin;if(totWin>0){const winType=totWin>=bet*50?'mega':totWin>=bet*10?'big':'normal';await this.winWithCelebration(totWin,'slots',winType);const winTypeText=totWin>=bet*50?'🌟 COSMIC JACKPOT':totWin>=bet*10?'💫 STELLAR WIN':totWin>=bet*5?'⭐ BIG WIN':'🌙 WIN';this.showRes('slots',`${winTypeText}! +${this.trimZeros(totWin.toFixed(8))} ${this.c}`,'win');this.createWinAnimationSequence(winningPositions,winType)}else{this.showRes('slots','🌌 No cosmic alignment! Try again!','lose');this.createNoWinEffect()}if(this.g.s.spins===0)this.g.s.state=null;this.updSlots();this.g.s.spin=0;this.unload(spinBtn,'⚡ SPIN ⚡');setTimeout(()=>{$$('.chaos-symbol').forEach(s=>{s.classList.remove('epic-winning');s.style.transform='scale(1) rotateZ(0deg)';s.style.background='linear-gradient(135deg,rgba(255,255,255,0.1),rgba(255,255,255,0.05))';s.style.borderColor='var(--pc)';s.style.boxShadow='none'})},3e3)}findClust(){const vis=Array(5).fill().map(()=>Array(6).fill(0)),clust=[];for(let r=0;r<5;r++)for(let c=0;c<6;c++)if(!vis[r][c]){const cl=this.findCl(r,c,this.g.s.grid[r][c],vis);if(cl.length>=5)clust.push({symbol:this.g.s.grid[r][c],positions:cl,size:cl.length})}return clust}findCl(r,c,sym,vis){if(r<0||r>=5||c<0||c>=6||vis[r][c]||this.g.s.grid[r][c]!==sym)return[];vis[r][c]=1;const cl=[{row:r,col:c}];[[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[-1,1],[1,-1],[1,1]].forEach(([dr,dc])=>cl.push(...this.findCl(r+dr,c+dc,sym,vis)));return cl}async epicBuyBonus(){const bet=+$('slotsBet').value,cost=bet*100;if(!await this.betWithFeedback(cost,'slots')){this.showRes('slots','💸 Insufficient balance for bonus purchase!','lose');return}this.g.s.spins=10;this.g.s.mult=3;this.g.s.state={spins:this.g.s.spins,mult:this.g.s.mult};this.saveGameState();this.notify('🚀 BONUS PURCHASED! 10 Free Spins with 3x Cosmic Multiplier!');this.enhancedVibration([100,25,100,25,100,25,100]);this.createBonusPurchaseSpectacle();setTimeout(()=>this.epicSpinSlots(),1500)}createResumeEffect(){const resume=document.createElement('div');resume.textContent='🎰 RESUMING';resume.style.cssText=`position:fixed;top:40%;left:50%;transform:translate(-50%,-50%);font-size:2rem;color:var(--cg);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:0;animation:resumeGlow 2s ease-in-out`;document.body.appendChild(resume);setTimeout(()=>resume.remove(),2e3)}createSpinStartEffect(){const grid=$('chaosGrid');if(grid){grid.style.transform='perspective(1000px) rotateX(5deg)';grid.style.filter='brightness(1.2) contrast(1.1)';setTimeout(()=>{grid.style.transform='perspective(1000px) rotateX(0deg)';grid.style.filter='brightness(1) contrast(1)'},600)}}createFreeSpinEffect(){const freeSpin=document.createElement('div');freeSpin.textContent='🆓 FREE SPIN';freeSpin.style.cssText=`position:fixed;top:30%;left:50%;transform:translate(-50%,-50%);font-size:1.5rem;color:var(--pc);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:1;transition:all 1s ease-out`;document.body.appendChild(freeSpin);setTimeout(()=>{freeSpin.style.transform='translate(-50%,-50%) scale(1.5) rotateZ(10deg)';freeSpin.style.opacity='0';setTimeout(()=>freeSpin.remove(),1e3)},100)}createScatterExplosion(count){for(let i=0;i<count*3;i++){setTimeout(()=>{const scatter=document.createElement('div');scatter.textContent='🌠';scatter.style.cssText=`position:fixed;top:50%;left:50%;font-size:2rem;pointer-events:none;z-index:1003;opacity:1;transition:all 2s cubic-bezier(0.25,0.46,0.45,0.94)`;document.body.appendChild(scatter);setTimeout(()=>{const angle=Math.random()*360;const distance=100+Math.random()*200;scatter.style.transform=`translate(-50%,-50%) rotate(${angle}deg) translateY(-${distance}px) scale(0.5)`;scatter.style.opacity='0';setTimeout(()=>scatter.remove(),2e3)},100)},i*100)}}createMeteorStrike(){const meteor=document.createElement('div');meteor.textContent='☄️';meteor.style.cssText=`position:fixed;top:-10%;left:${Math.random()*80+10}%;font-size:3rem;pointer-events:none;z-index:1003;opacity:1;transition:all 2s ease-in;transform:rotate(45deg)`;document.body.appendChild(meteor);setTimeout(()=>{meteor.style.top='110%';meteor.style.transform='rotate(45deg) scale(0.5)';meteor.style.opacity='0.3';setTimeout(()=>{meteor.remove();this.createBurst(8)},1800)},100)}createWinAnimationSequence(positions,type){positions.forEach((pos,index)=>{setTimeout(()=>{const idx=pos.row*6+pos.col,sym=$(`chaos-${idx}`);if(sym){const particle=document.createElement('div');particle.textContent='✨';particle.style.cssText=`position:absolute;top:50%;left:50%;font-size:1rem;color:var(--cg);pointer-events:none;z-index:1001;opacity:1;transition:all 0.8s ease-out`;sym.style.position='relative';sym.appendChild(particle);setTimeout(()=>{particle.style.transform=`translate(-50%,-50%) translateY(-30px) scale(2)`;particle.style.opacity='0';setTimeout(()=>particle.remove(),800)},50)}},index*50)});if(type==='mega'){setTimeout(()=>this.createMegaWinSpectacle(),500)}else if(type==='big'){setTimeout(()=>this.createBigWinShow(),300)}}createNoWinEffect(){$$('.chaos-symbol').forEach((sym,i)=>{setTimeout(()=>{sym.style.filter='brightness(0.7) saturate(0.5)';setTimeout(()=>sym.style.filter='brightness(1) saturate(1)',400)},i*20)})}createBonusPurchaseSpectacle(){this.createBurst(25);const bonus=document.createElement('div');bonus.textContent='🚀 BONUS ACTIVATED';bonus.style.cssText=`position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:2.5rem;color:var(--cg);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1003;opacity:0;text-shadow:0 0 20px var(--cg);border:3px solid var(--cg);padding:20px;border-radius:15px;background:rgba(0,0,0,0.8);animation:bonusActivation 3s ease-in-out`;document.body.appendChild(bonus);setTimeout(()=>bonus.remove(),3e3);for(let i=0;i<20;i++){setTimeout(()=>{const rocket=document.createElement('div');rocket.textContent='🚀';rocket.style.cssText=`position:fixed;top:100%;left:${Math.random()*100}%;font-size:1.5rem;pointer-events:none;z-index:1002;opacity:1;transition:all 3s ease-out`;document.body.appendChild(rocket);setTimeout(()=>{rocket.style.top='-10%';rocket.style.transform=`rotate(${-20+Math.random()*40}deg) scale(0.5)`;rocket.style.opacity='0';setTimeout(()=>rocket.remove(),3e3)},100)},i*100)}}

initPlinko(){const can=$('plinkoCanvas');if(!can)return;const container=can.parentElement;const maxW=Math.min(380,container.offsetWidth-10);can.width=maxW;can.height=Math.min(420,window.innerHeight*0.55);can.style.cssText='border-radius:15px;box-shadow:0 15px 35px rgba(0,0,0,0.3);background:linear-gradient(135deg,#1a2332,#2a3441)';this.ctx=can.getContext('2d');this.g.p.balls=[];this.setupEpicPegs();this.drawEpicBoard();const dropBtn=$('dropBtn');dropBtn.onclick=()=>{this.enhancedVibration(50);dropBtn.classList.add('drop-press');setTimeout(()=>dropBtn.classList.remove('drop-press'),300);this.epicDropBall()}}setupEpicPegs(){this.pegs=[];const w=this.ctx.canvas.width;for(let row=0;row<12;row++){const n=row+3,space=w*0.85/(n+1),start=(w-w*0.85)/2;for(let i=0;i<n;i++){const peg={x:start+space*(i+1),y:60+row*32,r:4,glow:Math.random()*0.5+0.5};this.pegs.push(peg)}}}drawEpicBoard(){const ctx=this.ctx,w=ctx.canvas.width,h=ctx.canvas.height;const gradient=ctx.createLinearGradient(0,0,0,h);gradient.addColorStop(0,'#1a2332');gradient.addColorStop(0.5,'#2a3441');gradient.addColorStop(1,'#1a2332');ctx.fillStyle=gradient;ctx.fillRect(0,0,w,h);this.pegs.forEach((p,i)=>{ctx.save();ctx.shadowColor='#4a5568';ctx.shadowBlur=5;ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);const pegGradient=ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r);pegGradient.addColorStop(0,`rgba(74,85,104,${p.glow})`);pegGradient.addColorStop(1,'#4a5568');ctx.fillStyle=pegGradient;ctx.fill();ctx.restore();if(i%10===0){ctx.save();ctx.shadowColor='#FFD700';ctx.shadowBlur=8;ctx.beginPath();ctx.arc(p.x,p.y,p.r+1,0,Math.PI*2);ctx.strokeStyle='rgba(255,215,0,0.3)';ctx.lineWidth=1;ctx.stroke();ctx.restore()}});this.g.p.balls.forEach(b=>{ctx.save();ctx.shadowColor=b.color;ctx.shadowBlur=10;ctx.beginPath();ctx.arc(b.x,b.y,b.r,0,Math.PI*2);const ballGradient=ctx.createRadialGradient(b.x-2,b.y-2,0,b.x,b.y,b.r);ballGradient.addColorStop(0,'rgba(255,255,255,0.8)');ballGradient.addColorStop(0.7,b.color);ballGradient.addColorStop(1,b.darkColor);ctx.fillStyle=ballGradient;ctx.fill();ctx.beginPath();ctx.arc(b.x-1,b.y-1,b.r*0.3,0,Math.PI*2);ctx.fillStyle='rgba(255,255,255,0.6)';ctx.fill();ctx.restore()})}async epicDropBall(){const bet=+$('plinkoBet').value;if(!await this.betWithFeedback(bet,'plinko'))return;if(this.g.p.balls.length>=this.g.p.max){this.notify(`🌌 Maximum ${this.g.p.max} cosmic orbs in flight!`);return}const w=this.ctx.canvas.width,hue=Math.random()*360,ballColor=`hsl(${hue},70%,60%)`,darkColor=`hsl(${hue},70%,40%)`;this.g.p.balls.push({id:Date.now()+Math.random(),x:w/2+(Math.random()-.5)*15,y:20,vx:(Math.random()-.5)*.2,vy:0,r:7,g:.055,b:.92,bet,color:ballColor,darkColor,trail:[],glow:1,energy:1});this.createBallDropEffect();this.epicAnimPlinko()}epicAnimPlinko(){const anim=()=>{this.g.p.balls.forEach((b,idx)=>{b.trail.push({x:b.x,y:b.y,life:1});if(b.trail.length>8)b.trail.shift();b.trail.forEach(t=>{t.life*=0.9});b.vy+=b.g;b.vy*=.999;b.vx*=.995;b.x+=b.vx;b.y+=b.vy;b.energy*=0.998;this.pegs.forEach(p=>{const dx=b.x-p.x,dy=b.y-p.y,d=Math.sqrt(dx*dx+dy*dy);if(d<b.r+p.r){const angle=Math.atan2(dy,dx);const overlap=b.r+p.r-d;b.x=p.x+Math.cos(angle)*(b.r+p.r+1);b.y=p.y+Math.sin(angle)*(b.r+p.r+1);const speed=Math.sqrt(b.vx*b.vx+b.vy*b.vy);b.vx=Math.cos(angle)*speed*b.b*0.4+(Math.random()-.5)*0.6;b.vy=Math.abs(b.vy)*b.b*(0.6+Math.random()*0.2);b.energy+=0.1;this.enhancedVibration(Math.min(15,Math.floor(speed*5)));this.createPegHitEffect(p.x,p.y)}});const w=this.ctx.canvas.width,h=this.ctx.canvas.height;if(b.x<b.r||b.x>w-b.r){b.vx*=-.8;b.x=b.x<b.r?b.r:w-b.r;this.createWallBounceEffect(b.x,b.y)}if(b.y>h-40){const slot=Math.floor(b.x/(w/13)),mults=[10,3,1.5,1.4,1.1,1,.5,1,1.1,1.4,1.5,3,10],mult=mults[Math.max(0,Math.min(12,slot))],win=b.bet*mult;this.add(win,'win');const winType=mult>=3?'big':mult>=1.4?'normal':'lose';this.showRes('plinko',`🌌 Cosmic orb landed on ${mult}x! Won ${this.trimZeros(win.toFixed(8))} ${this.c}`,win>=b.bet?'win':'lose');this.createSlotLandEffect(slot,mult,win);$$('.multiplier').forEach((m,i)=>{if(i===slot){m.classList.add('epic-hit');setTimeout(()=>m.classList.remove('epic-hit'),2e3)}});this.enhancedVibration(mult>=2?[100,50,100]:[50]);this.g.p.balls.splice(idx,1)}});this.drawEpicBoard();if(this.g.p.balls.length>0)requestAnimationFrame(anim)};anim()}createBallDropEffect(){const effect=document.createElement('div');effect.textContent='🌌';effect.style.cssText=`position:fixed;top:20%;left:50%;transform:translate(-50%,-50%);font-size:2rem;pointer-events:none;z-index:1002;opacity:1;transition:all 1s ease-out`;document.body.appendChild(effect);setTimeout(()=>{effect.style.transform='translate(-50%,-50%) translateY(50px) scale(0.5)';effect.style.opacity='0';setTimeout(()=>effect.remove(),1e3)},100)}createPegHitEffect(x,y){const canvas=this.ctx.canvas,rect=canvas.getBoundingClientRect(),sparkle=document.createElement('div');sparkle.style.cssText=`position:fixed;top:${rect.top+y}px;left:${rect.left+x}px;width:4px;height:4px;background:#FFD700;border-radius:50%;pointer-events:none;z-index:1001;opacity:1;transition:all 0.4s ease-out;box-shadow:0 0 8px #FFD700`;document.body.appendChild(sparkle);setTimeout(()=>{sparkle.style.transform='scale(3) translateY(-20px)';sparkle.style.opacity='0';setTimeout(()=>sparkle.remove(),400)},50)}createWallBounceEffect(x,y){const canvas=this.ctx.canvas,rect=canvas.getBoundingClientRect(),bounce=document.createElement('div');bounce.style.cssText=`position:fixed;top:${rect.top+y}px;left:${rect.left+x}px;width:20px;height:20px;border:2px solid #00E5FF;border-radius:50%;pointer-events:none;z-index:1001;opacity:1;transition:all 0.6s ease-out`;document.body.appendChild(bounce);setTimeout(()=>{bounce.style.width='40px';bounce.style.height='40px';bounce.style.opacity='0';setTimeout(()=>bounce.remove(),600)},10)}createSlotLandEffect(slot,mult,win){this.createBurst(mult>=3?12:mult>=1.4?6:3);if(mult>=3){for(let i=0;i<5;i++){setTimeout(()=>{const star=document.createElement('div');star.textContent='⭐';star.style.cssText=`position:fixed;top:70%;left:${40+slot*4}%;font-size:1.5rem;pointer-events:none;z-index:1002;opacity:1;transition:all 1.5s ease-out`;document.body.appendChild(star);setTimeout(()=>{star.style.transform='translateY(-100px) scale(2) rotate(360deg)';star.style.opacity='0';setTimeout(()=>star.remove(),1500)},100)},i*100)}}if(win>0){this.createWinEffect(win)}}initBJ(){this.g.bj={pH:[],dH:[],deck:[],act:0,bet:0,dbl:0,spl:0,ins:0,spH:[],cDbl:0,cSpl:0};this.createEpicDeck();this.shuffleEpicDeck();this.resetEpicBJ();this.setupEpicBJ()}setupEpicBJ(){const ctrls=$('dealBtn').parentElement;['double','split','insurance'].forEach(name=>{if(!$(`${name}Btn`)){const btn=document.createElement('button');btn.id=`${name}Btn`;btn.className='cosmic-btn epic-bj-btn';btn.textContent=name.toUpperCase();btn.disabled=!0;btn.style.cssText='margin:5px;padding:8px 15px;font-size:0.9rem;transition:all 0.3s ease;transform:scale(0.95)';btn.onclick=()=>{this.enhancedVibration(50);btn.classList.add('bj-btn-press');setTimeout(()=>btn.classList.remove('bj-btn-press'),200);this[`${name}BJ`]()};ctrls.appendChild(btn)}});const dealBtn=$('dealBtn'),hitBtn=$('hitBtn'),standBtn=$('standBtn');dealBtn.onclick=()=>{this.enhancedVibration(50);this.createDealEffect();this.dealEpicBJ()};hitBtn.onclick=()=>{this.enhancedVibration(25);this.createHitEffect();this.hitEpicBJ()};standBtn.onclick=()=>{this.enhancedVibration(25);this.createStandEffect();this.standEpicBJ()}}createEpicDeck(){const suits=['♠','♥','♦','♣'],vals=['A','2','3','4','5','6','7','8','9','10','J','Q','K'];this.g.bj.deck=[];for(let d=0;d<6;d++)suits.forEach(s=>vals.forEach(v=>this.g.bj.deck.push({v,s,id:Math.random()})))}shuffleEpicDeck(){const deck=this.g.bj.deck;for(let i=deck.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[deck[i],deck[j]]=[deck[j],deck[i]]}}resetEpicBJ(){const playerCards=$('playerCards'),dealerCards=$('dealerCards');playerCards.innerHTML='';dealerCards.innerHTML='';playerCards.style.minHeight='120px';dealerCards.style.minHeight='120px';$('playerScore').textContent='0';$('dealerScore').textContent='0';$('dealBtn').disabled=0;['hitBtn','standBtn','doubleBtn','splitBtn','insuranceBtn'].forEach(id=>{const btn=$(id);if(btn)btn.disabled=1});Object.assign(this.g.bj,{dbl:0,spl:0,ins:0,spH:[],cDbl:0,cSpl:0})}async dealEpicBJ(){const bet=+$('blackjackBet').value;if(!await this.betWithFeedback(bet,'blackjack'))return;this.g.bj.bet=bet;this.g.bj.act=1;this.g.bj.pH=[this.g.bj.deck.pop(),this.g.bj.deck.pop()];this.g.bj.dH=[this.g.bj.deck.pop(),this.g.bj.deck.pop()];this.epicUpdBJ();$('dealBtn').disabled=1;setTimeout(()=>{$('hitBtn').disabled=0;$('standBtn').disabled=0;this.checkEpicOpts();if(this.getHandVal(this.g.bj.pH)===21){this.createBlackjackEffect();setTimeout(()=>this.standEpicBJ(),1e3)}},800)}checkEpicOpts(){if(this.g.bj.pH.length===2){this.g.bj.cDbl=1;const doubleBtn=$('doubleBtn');if(doubleBtn){doubleBtn.disabled=0;doubleBtn.style.transform='scale(1)';doubleBtn.classList.add('option-available')}if(this.g.bj.pH[0].v===this.g.bj.pH[1].v){this.g.bj.cSpl=1;const splitBtn=$('splitBtn');if(splitBtn){splitBtn.disabled=0;splitBtn.style.transform='scale(1)';splitBtn.classList.add('option-available')}}}if(this.g.bj.dH[0].v==='A'){const insBtn=$('insuranceBtn');if(insBtn){insBtn.disabled=0;insBtn.style.transform='scale(1)';insBtn.classList.add('option-available')}}}async hitEpicBJ(){if(!this.g.bj.act)return;this.g.bj.pH.push(this.g.bj.deck.pop());this.g.bj.cDbl=0;this.g.bj.cSpl=0;['doubleBtn','splitBtn'].forEach(id=>{const btn=$(id);if(btn){btn.disabled=1;btn.style.transform='scale(0.95)';btn.classList.remove('option-available')}});this.epicUpdBJ();const pVal=this.getHandVal(this.g.bj.pH);if(pVal>21){this.enhancedVibration(100);this.createBustEffect();setTimeout(()=>this.endEpicBJ('💥 COSMIC BUST! Dealer wins',0),1e3)}else if(pVal===21){this.createTwentyOneEffect();setTimeout(()=>this.standEpicBJ(),800)}}async doubleBJ(){if(!this.g.bj.cDbl||this.g.bj.dbl||!await this.betWithFeedback(this.g.bj.bet,'blackjack'))return;this.g.bj.bet*=2;this.g.bj.dbl=1;this.g.bj.pH.push(this.g.bj.deck.pop());this.createDoubleDownEffect();this.epicUpdBJ();['hitBtn','doubleBtn','splitBtn','insuranceBtn'].forEach(id=>{const btn=$(id);if(btn){btn.disabled=1;btn.classList.remove('option-available')}});setTimeout(()=>{if(this.getHandVal(this.g.bj.pH)<=21)this.standEpicBJ();else{this.enhancedVibration(100);this.createBustEffect();this.endEpicBJ('💥 Double down BUST! Dealer wins',0)}},1e3)}async splitBJ(){if(!this.g.bj.cSpl||this.g.bj.spl||!await this.betWithFeedback(this.g.bj.bet,'blackjack'))return;this.g.bj.spl=1;this.g.bj.spH=[this.g.bj.pH.pop()];this.g.bj.pH.push(this.g.bj.deck.pop());this.g.bj.spH.push(this.g.bj.deck.pop());this.createSplitEffect();this.epicUpdBJ();['splitBtn','doubleBtn'].forEach(id=>{const btn=$(id);if(btn){btn.disabled=1;btn.classList.remove('option-available')}});this.showRes('blackjack','⚡ Cards split! Playing first hand then second','info')}async insuranceBJ(){if(this.g.bj.ins||this.g.bj.dH[0].v!=='A')return;const iBet=this.g.bj.bet/2;if(!await this.betWithFeedback(iBet,'blackjack'))return;this.g.bj.ins=iBet;$('insuranceBtn').disabled=1;this.createInsuranceEffect();this.showRes('blackjack','🛡️ Insurance purchased','info')}async standEpicBJ(){if(!this.g.bj.act)return;['hitBtn','standBtn','doubleBtn','splitBtn','insuranceBtn'].forEach(id=>{const btn=$(id);if(btn){btn.disabled=1;btn.classList.remove('option-available')}});this.createStandEffect();while(this.getHandVal(this.g.bj.dH)<17){await new Promise(res=>setTimeout(()=>{this.g.bj.dH.push(this.g.bj.deck.pop());this.epicUpdBJ(1);this.createDealerHitEffect();res()},600))}this.resolveEpicBJ()}resolveEpicBJ(){const pVal=this.getHandVal(this.g.bj.pH),dVal=this.getHandVal(this.g.bj.dH);let win=0,msg='';if(this.g.bj.ins&&dVal===21){win+=this.g.bj.ins*2;msg+='🛡️ Insurance pays! '}const outs=[{c:()=>pVal>21,m:'💥 Hand 1 busts!',w:0},{c:()=>dVal>21,m:'🎉 Hand 1 wins! Dealer busts!',w:this.g.bj.bet*2},{c:()=>pVal===21&&this.g.bj.pH.length===2&&dVal!==21,m:'🃏 Hand 1 BLACKJACK!',w:this.g.bj.bet*2.5},{c:()=>pVal>dVal,m:'⭐ Hand 1 wins!',w:this.g.bj.bet*2},{c:()=>pVal<dVal,m:'😔 Hand 1 loses',w:0},{c:()=>pVal===dVal,m:'🤝 Hand 1 pushes',w:this.g.bj.bet}],out=outs.find(o=>o.c());if(out){msg+=out.m;win+=out.w}if(this.g.bj.spl){const spVal=this.getHandVal(this.g.bj.spH),spOuts=[{c:()=>spVal>21,m:' | Hand 2 busts',w:0},{c:()=>dVal>21,m:' | Hand 2 wins!',w:this.g.bj.bet*2},{c:()=>spVal===21&&this.g.bj.spH.length===2&&dVal!==21,m:' | Hand 2 BLACKJACK!',w:this.g.bj.bet*2.5},{c:()=>spVal>dVal,m:' | Hand 2 wins!',w:this.g.bj.bet*2},{c:()=>spVal<dVal,m:' | Hand 2 loses',w:0},{c:()=>spVal===dVal,m:' | Hand 2 pushes',w:this.g.bj.bet}],spOut=spOuts.find(o=>o.c());if(spOut){msg+=spOut.m;win+=spOut.w}}this.endEpicBJ(msg,win)}getHandVal(hand){let val=0,aces=0;hand.forEach(c=>{if(c.v==='A'){aces++;val+=11}else val+=(['J','Q','K'].includes(c.v)?10:+c.v)});while(val>21&&aces>0){val-=10;aces--}return val}epicUpdBJ(showAll=0){this.showEpicHand('player',this.g.bj.pH,1);this.showEpicHand('dealer',this.g.bj.dH,showAll||!this.g.bj.act);if(this.g.bj.spl){const pCards=$('playerCards'),div=document.createElement('div');div.textContent='|';div.style.cssText='color:#FFD700;font-size:2rem;margin:0 1rem;align-self:center;text-shadow:0 0 10px #FFD700';pCards.appendChild(div);this.g.bj.spH.forEach((c,i)=>{const card=this.createEpicCard(c,i+(this.g.bj.pH.length));pCards.appendChild(card)})}const playerScore=this.g.bj.spl?`${this.getHandVal(this.g.bj.pH)} | ${this.getHandVal(this.g.bj.spH)}`:this.getHandVal(this.g.bj.pH);$('playerScore').textContent=playerScore;$('dealerScore').textContent=(showAll||!this.g.bj.act)?this.getHandVal(this.g.bj.dH):this.getHandVal([this.g.bj.dH[0]])}showEpicHand(who,hand,showAll=1){const el=$(`${who}Cards`);if(!el)return;el.innerHTML='';hand.forEach((c,i)=>{const card=who==='dealer'&&i===1&&!showAll?this.createHiddenCard(i):this.createEpicCard(c,i);el.appendChild(card)})}createEpicCard(card,index){const cardEl=document.createElement('div');cardEl.className='playing-card epic-card';cardEl.style.cssText=`width:80px;height:120px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border:3px solid var(--cg);border-radius:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:1.1rem;font-weight:700;color:var(--sb);transition:all 0.6s cubic-bezier(0.175,0.885,0.32,1.275);box-shadow:0 8px 25px rgba(0,0,0,0.15);position:relative;overflow:hidden;animation:cardDealEpic 0.8s ease-out;animation-delay:${index*200}ms;animation-fill-mode:backwards;transform-style:preserve-3d`;cardEl.innerHTML=`${card.v}<br>${card.s}`;if(['♥','♦'].includes(card.s))cardEl.classList.add('red');cardEl.addEventListener('mouseenter',()=>{cardEl.style.transform='translateY(-8px) rotateY(5deg)';cardEl.style.boxShadow='0 15px 35px rgba(0,0,0,0.2)'});cardEl.addEventListener('mouseleave',()=>{cardEl.style.transform='translateY(0) rotateY(0deg)';cardEl.style.boxShadow='0 8px 25px rgba(0,0,0,0.15)'});return cardEl}createHiddenCard(index){const cardEl=document.createElement('div');cardEl.className='playing-card epic-card back';cardEl.style.cssText=`width:80px;height:120px;background:linear-gradient(135deg,var(--cp),var(--cb));color:var(--cg);font-size:2rem;border:3px solid var(--cg);border-radius:12px;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 25px rgba(74,20,140,0.4);animation:cardDealEpic 0.8s ease-out;animation-delay:${index*200}ms;animation-fill-mode:backwards;position:relative;overflow:hidden`;cardEl.textContent='🚀';const shimmer=document.createElement('div');shimmer.style.cssText='position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent,rgba(255,215,0,0.3),transparent);animation:shimmer 2s ease-in-out infinite';cardEl.appendChild(shimmer);return cardEl}async endEpicBJ(msg,win=0){this.g.bj.act=0;if(win>0){await this.winWithCelebration(win,'blackjack',win>=this.g.bj.bet*2?'big':'normal');msg+=` +${this.trimZeros(win.toFixed(8))} ${this.c}`;this.enhancedVibration([50,25,50])}else this.enhancedVibration(100);this.epicUpdBJ(1);this.showRes('blackjack',msg,win>0?'win':'lose');setTimeout(()=>{this.resetEpicBJ();this.createEpicDeck();this.shuffleEpicDeck()},3e3)}createDealEffect(){this.createBurst(5)}createHitEffect(){this.createSparkle($('hitBtn'))}createStandEffect(){this.createRipple($('standBtn'))}createBlackjackEffect(){this.createBurst(15);const bj=document.createElement('div');bj.textContent='🃏 BLACKJACK!';bj.style.cssText=`position:fixed;top:40%;left:50%;transform:translate(-50%,-50%);font-size:2.5rem;color:var(--cg);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1003;opacity:0;text-shadow:0 0 20px var(--cg);animation:blackjackFlash 2s ease-in-out`;document.body.appendChild(bj);setTimeout(()=>bj.remove(),2e3)}createBustEffect(){$$('.playing-card').forEach((card,i)=>{setTimeout(()=>{card.style.filter='brightness(0.5) saturate(0.3)';card.style.transform='rotateX(180deg)'},i*100)})}createTwentyOneEffect(){this.createBurst(8);const twentyOne=document.createElement('div');twentyOne.textContent='21!';twentyOne.style.cssText=`position:fixed;top:35%;left:50%;transform:translate(-50%,-50%);font-size:3rem;color:var(--cg);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:1;transition:all 1s ease-out;text-shadow:0 0 15px var(--cg)`;document.body.appendChild(twentyOne);setTimeout(()=>{twentyOne.style.transform='translate(-50%,-50%) scale(1.5) rotateZ(10deg)';twentyOne.style.opacity='0';setTimeout(()=>twentyOne.remove(),1e3)},100)}createDoubleDownEffect(){this.createBurst(10);const double=document.createElement('div');double.textContent='2X DOUBLE!';double.style.cssText=`position:fixed;top:30%;right:20%;font-size:1.5rem;color:var(--pc);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:1;transition:all 1.2s ease-out;text-shadow:0 0 10px var(--pc)`;document.body.appendChild(double);setTimeout(()=>{double.style.transform='translateY(-50px) scale(1.3)';double.style.opacity='0';setTimeout(()=>double.remove(),1200)},100)}createSplitEffect(){this.createBurst(6);const split=document.createElement('div');split.textContent='⚡ SPLIT';split.style.cssText=`position:fixed;top:30%;left:20%;font-size:1.5rem;color:var(--cm);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:1;transition:all 1s ease-out;text-shadow:0 0 10px var(--cm)`;document.body.appendChild(split);setTimeout(()=>{split.style.transform='translateY(-40px) scale(1.2)';split.style.opacity='0';setTimeout(()=>split.remove(),1e3)},100)}createInsuranceEffect(){const insurance=document.createElement('div');insurance.textContent='🛡️ INSURED';insurance.style.cssText=`position:fixed;top:25%;left:50%;transform:translate(-50%,-50%);font-size:1.3rem;color:var(--wg);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:1;transition:all 1s ease-out;text-shadow:0 0 8px var(--wg)`;document.body.appendChild(insurance);setTimeout(()=>{insurance.style.transform='translate(-50%,-50%) translateY(-30px)';insurance.style.opacity='0';setTimeout(()=>insurance.remove(),1e3)},100)}createDealerHitEffect(){const hit=document.createElement('div');hit.textContent='🎯';hit.style.cssText=`position:fixed;top:20%;left:50%;transform:translate(-50%,-50%);font-size:1.5rem;pointer-events:none;z-index:1001;opacity:1;transition:all 0.8s ease-out`;document.body.appendChild(hit);setTimeout(()=>{hit.style.transform='translate(-50%,-50%) scale(0.5) translateY(-20px)';hit.style.opacity='0';setTimeout(()=>hit.remove(),800)},100)}

initHilo(){this.g.h={card:null,strk:0,bet:0,act:0};this.resetEpicHilo();const dealBtn=$('dealHiloBtn'),higherBtn=$('higherBtn'),lowerBtn=$('lowerBtn'),cashBtn=$('cashoutBtn');dealBtn.onclick=()=>{this.enhancedVibration(50);dealBtn.classList.add('epic-deal-press');setTimeout(()=>dealBtn.classList.remove('epic-deal-press'),300);this.createDealSparkle();this.startEpicHilo()};higherBtn.onclick=()=>{this.enhancedVibration(25);higherBtn.classList.add('higher-press');setTimeout(()=>higherBtn.classList.remove('higher-press'),200);this.createPredictionEffect('higher');this.guessEpicHilo('higher')};lowerBtn.onclick=()=>{this.enhancedVibration(25);lowerBtn.classList.add('lower-press');setTimeout(()=>lowerBtn.classList.remove('lower-press'),200);this.createPredictionEffect('lower');this.guessEpicHilo('lower')};cashBtn.onclick=()=>{this.enhancedVibration([75,25,75]);cashBtn.classList.add('cash-press');setTimeout(()=>cashBtn.classList.remove('cash-press'),300);this.createCashoutEffect();this.cashEpicHilo()}}resetEpicHilo(){const currentCard=$('currentCard'),dealBtn=$('dealHiloBtn');currentCard.innerHTML='<div class="playing-card hilo-main-card epic-mystery-card"><div class="mystery-content">?<div class="mystery-glow"></div></div></div>';dealBtn.style.display='block';['higherBtn','lowerBtn','cashoutBtn'].forEach(id=>{const btn=$(id);if(btn){btn.disabled=1;btn.style.opacity='0.5';btn.style.transform='scale(0.9)'}});this.epicUpdStreak()}async startEpicHilo(){const bet=+$('hiloBet').value;if(!await this.betWithFeedback(bet,'hilo'))return;Object.assign(this.g.h,{bet,strk:0,act:1,card:this.getEpicRandCard()});this.createCardRevealEffect();await this.epicDispCard('currentCard',this.g.h.card);$('dealHiloBtn').style.display='none';['higherBtn','lowerBtn','cashoutBtn'].forEach(id=>{const btn=$(id);if(btn){btn.disabled=0;btn.style.opacity='1';btn.style.transform='scale(1)';btn.classList.add('btn-available')}});this.epicUpdStreak();this.createGameStartEffect()}guessEpicHilo(guess){if(!this.g.h.act)return;const next=this.getEpicRandCard(),curr=this.getCardVal(this.g.h.card),nextVal=this.getCardVal(next),correct=(guess==='higher'&&nextVal>curr)||(guess==='lower'&&nextVal<curr);this.createSuspenseEffect();setTimeout(async()=>{await this.epicDispCard('currentCard',next);if(correct){this.g.h.strk++;this.g.h.card=next;this.epicUpdStreak();this.showRes('hilo',`🎉 Cosmic alignment! Streak: ${this.g.h.strk}x multiplier!`,'win');this.enhancedVibration([25,50,25]);this.createCorrectGuessEffect(this.g.h.strk)}else{this.showRes('hilo',`💫 Cosmic misalignment! Final streak: ${this.g.h.strk}x`,'lose');this.enhancedVibration(100);this.createWrongGuessEffect();this.endEpicHilo()}},800)}async cashEpicHilo(){if(!this.g.h.act)return;const multiplier=Math.pow(2,this.g.h.strk),win=this.g.h.bet*multiplier;await this.winWithCelebration(win,'hilo',this.g.h.strk>=5?'mega':this.g.h.strk>=3?'big':'normal');this.showRes('hilo',`💰 Cosmic fortune secured! Won ${this.trimZeros(win.toFixed(8))} ${this.c} (${multiplier}x)`,'win');this.createCashoutCelebration(this.g.h.strk);this.endEpicHilo()}autoCashHilo(){if(!this.g.h.act)return;const multiplier=Math.pow(2,this.g.h.strk),win=this.g.h.bet*multiplier;this.add(win,'win');this.notify(`💰 Auto cosmic cash-out! Won ${this.trimZeros(win.toFixed(8))} ${this.c} (${multiplier}x)`);this.createAutoCashEffect();this.endEpicHilo()}endEpicHilo(){this.g.h.act=0;['higherBtn','lowerBtn','cashoutBtn'].forEach(id=>{const btn=$(id);if(btn){btn.disabled=1;btn.style.opacity='0.5';btn.style.transform='scale(0.9)';btn.classList.remove('btn-available')}});setTimeout(()=>this.resetEpicHilo(),4e3)}epicUpdStreak(){const cont=$('streakCards'),countEl=$('.streak-count');if(countEl){const oldCount=parseInt(countEl.textContent)||0;countEl.textContent=this.g.h.strk;if(this.g.h.strk>oldCount){countEl.style.transform='scale(1.3)';countEl.style.color='var(--cg)';setTimeout(()=>{countEl.style.transform='scale(1)';countEl.style.color=''},400)}countEl.classList.add('streak-update');setTimeout(()=>countEl.classList.remove('streak-update'),600)}if(!cont)return;const multiplier=Math.pow(2,this.g.h.strk);cont.innerHTML=this.g.h.strk===0?'<div class="streak-placeholder epic-placeholder">Begin your cosmic journey!</div>':'';for(let i=0;i<Math.min(this.g.h.strk,12);i++){const card=document.createElement('div');card.className='streak-card epic-streak-card';card.innerHTML=`<div class="streak-number">${i+1}</div><div class="streak-symbol">🃏</div>`;card.style.cssText=`min-width:40px;height:55px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border:2px solid var(--pc);border-radius:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:0.7rem;font-weight:700;color:var(--sb);flex-shrink:0;animation:streakCardAppear 0.6s ease-out;animation-delay:${i*100}ms;animation-fill-mode:backwards;box-shadow:0 4px 15px rgba(0,229,255,0.2);position:relative;overflow:hidden`;if(i===this.g.h.strk-1){card.style.borderColor='var(--cg)';card.style.boxShadow='0 0 20px var(--cg)';card.classList.add('current-streak')}cont.appendChild(card)}if(this.g.h.strk>0){const multiplierDisplay=document.createElement('div');multiplierDisplay.className='multiplier-display';multiplierDisplay.textContent=`${multiplier}x Payout`;multiplierDisplay.style.cssText=`margin-top:10px;font-family:JetBrains Mono,monospace;font-weight:700;color:var(--cg);font-size:1.1rem;text-align:center;text-shadow:0 0 10px var(--cg);animation:multiplierPulse 2s ease-in-out infinite`;cont.appendChild(multiplierDisplay)}}getEpicRandCard(){const suits=['♠','♥','♦','♣'],vals=['A','2','3','4','5','6','7','8','9','10','J','Q','K'];return{suit:suits[Math.floor(Math.random()*4)],value:vals[Math.floor(Math.random()*13)],id:Math.random()}}getCardVal(card){return card.value==='A'?1:['J','Q','K'].includes(card.value)?[11,12,13][['J','Q','K'].indexOf(card.value)]:parseInt(card.value)}async epicDispCard(id,card){const cont=$(id);return new Promise(resolve=>{cont.style.transform='perspective(1000px) rotateY(90deg)';cont.style.filter='blur(2px)';setTimeout(()=>{cont.innerHTML='';const cardEl=document.createElement('div');cardEl.className='playing-card hilo-main-card epic-hilo-card';cardEl.innerHTML=`<div class="card-content">${card.value}<br>${card.suit}<div class="card-shine"></div></div>`;cardEl.style.cssText=`width:140px;height:200px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border:4px solid var(--cg);border-radius:15px;display:flex;align-items:center;justify-content:center;font-size:2.2rem;font-weight:700;color:var(--sb);box-shadow:0 15px 40px rgba(255,215,0,0.3);position:relative;overflow:hidden;transform-style:preserve-3d`;if(['♥','♦'].includes(card.suit)){cardEl.classList.add('red');cardEl.style.color='var(--cp)'}const shine=cardEl.querySelector('.card-shine');if(shine){shine.style.cssText='position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent,rgba(255,255,255,0.3),transparent);animation:cardShine 3s ease-in-out infinite'}cont.appendChild(cardEl);cont.style.transform='perspective(1000px) rotateY(0deg)';cont.style.filter='blur(0px)';setTimeout(()=>resolve(),300)},300)})}createDealSparkle(){for(let i=0;i<8;i++){setTimeout(()=>{const sparkle=document.createElement('div');sparkle.style.cssText=`position:fixed;top:40%;left:50%;width:3px;height:3px;background:var(--cg);border-radius:50%;pointer-events:none;z-index:1002;opacity:1;transition:all 1s ease-out;box-shadow:0 0 10px var(--cg)`;document.body.appendChild(sparkle);setTimeout(()=>{const angle=i*45;sparkle.style.transform=`translate(-50%,-50%) rotate(${angle}deg) translateY(-${40+Math.random()*30}px) scale(2)`;sparkle.style.opacity='0';setTimeout(()=>sparkle.remove(),1e3)},100)},i*50)}}createCardRevealEffect(){const reveal=document.createElement('div');reveal.textContent='🔮 REVEALING COSMIC CARD';reveal.style.cssText=`position:fixed;top:35%;left:50%;transform:translate(-50%,-50%);font-size:1.5rem;color:var(--pc);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:0;animation:revealText 2s ease-in-out`;document.body.appendChild(reveal);setTimeout(()=>reveal.remove(),2e3)}createGameStartEffect(){this.createBurst(6);const start=document.createElement('div');start.textContent='🌟 COSMIC PREDICTION BEGINS';start.style.cssText=`position:fixed;top:25%;left:50%;transform:translate(-50%,-50%);font-size:1.3rem;color:var(--cg);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:1;transition:all 2s ease-out;text-shadow:0 0 15px var(--cg)`;document.body.appendChild(start);setTimeout(()=>{start.style.opacity='0';start.style.transform='translate(-50%,-50%) translateY(-50px)';setTimeout(()=>start.remove(),2e3)},500)}createPredictionEffect(type){const pred=document.createElement('div');pred.textContent=type==='higher'?'⬆️ HIGHER':'⬇️ LOWER';pred.style.cssText=`position:fixed;top:30%;${type==='higher'?'right':'left'}:20%;font-size:1.8rem;color:${type==='higher'?'var(--wg)':'var(--lr)'};font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:1;transition:all 1s ease-out;text-shadow:0 0 12px currentColor`;document.body.appendChild(pred);setTimeout(()=>{pred.style.transform=`translateY(-40px) scale(1.2)`;pred.style.opacity='0';setTimeout(()=>pred.remove(),1e3)},100)}createSuspenseEffect(){const suspense=document.createElement('div');suspense.textContent='🌌 COSMIC FORCES ALIGNING...';suspense.style.cssText=`position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:1.2rem;color:var(--pc);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:0;animation:suspensePulse 0.8s ease-in-out`;document.body.appendChild(suspense);setTimeout(()=>suspense.remove(),800)}createCorrectGuessEffect(streak){this.createBurst(3+streak);const correct=document.createElement('div');correct.textContent=`✨ STREAK ${streak}x MULTIPLIER!`;correct.style.cssText=`position:fixed;top:20%;left:50%;transform:translate(-50%,-50%);font-size:${1.2+streak*0.1}rem;color:var(--cg);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1003;opacity:1;transition:all 1.5s ease-out;text-shadow:0 0 20px var(--cg)`;document.body.appendChild(correct);setTimeout(()=>{correct.style.transform='translate(-50%,-50%) scale(1.3) rotateZ(5deg)';correct.style.opacity='0';setTimeout(()=>correct.remove(),1500)},200)}createWrongGuessEffect(){$$('.epic-hilo-card').forEach(card=>{card.style.filter='brightness(0.5) saturate(0.3)';card.style.transform='rotateX(10deg)'})}createCashoutEffect(){this.createBurst(8);const cashout=document.createElement('div');cashout.textContent='💰 CASHING OUT';cashout.style.cssText=`position:fixed;top:40%;left:50%;transform:translate(-50%,-50%);font-size:2rem;color:var(--wg);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:1;transition:all 1s ease-out;text-shadow:0 0 15px var(--wg)`;document.body.appendChild(cashout);setTimeout(()=>{cashout.style.transform='translate(-50%,-50%) scale(1.2)';cashout.style.opacity='0';setTimeout(()=>cashout.remove(),1e3)},200)}createCashoutCelebration(streak){for(let i=0;i<streak;i++){setTimeout(()=>{const coin=document.createElement('div');coin.textContent='🪙';coin.style.cssText=`position:fixed;top:30%;left:${30+Math.random()*40}%;font-size:2rem;pointer-events:none;z-index:1003;opacity:1;transition:all 2s ease-out`;document.body.appendChild(coin);setTimeout(()=>{coin.style.transform=`translateY(50vh) rotate(${360+Math.random()*360}deg) scale(0.7)`;coin.style.opacity='0';setTimeout(()=>coin.remove(),2e3)},100)},i*150)}}createAutoCashEffect(){const auto=document.createElement('div');auto.textContent='🤖 AUTO CASH-OUT';auto.style.cssText=`position:fixed;top:35%;left:50%;transform:translate(-50%,-50%);font-size:1.5rem;color:var(--pc);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:1;transition:all 1.2s ease-out;text-shadow:0 0 12px var(--pc)`;document.body.appendChild(auto);setTimeout(()=>{auto.style.opacity='0';auto.style.transform='translate(-50%,-50%) translateY(-60px)';setTimeout(()=>auto.remove(),1200)},300)}initDice(){this.g.d={bet:null,v1:1,v2:1,roll:0,hot:[]};this.setupEpicDice();this.resetEpicDice();this.enhanceDice();const rollBtn=$('rollBtn');rollBtn.onclick=()=>{this.enhancedVibration(75);rollBtn.classList.add('epic-roll-press');setTimeout(()=>rollBtn.classList.remove('epic-roll-press'),400);this.createRollEffect();this.epicRollDice()};$$('.bet-option').forEach(btn=>btn.onclick=()=>{this.enhancedVibration(25);btn.classList.add('bet-select');setTimeout(()=>btn.classList.remove('bet-select'),200);this.epicSelBet(btn.dataset.bet)})}enhanceDice(){const cont=$('dice')?.querySelector('.dice-betting'),opts=cont?.querySelector('.bet-options');if(opts){opts.innerHTML=['low','seven','high','hard','field'].map((bet,i)=>{const labels=['LOW (2-6) - 2x','SEVEN (7) - 5x','HIGH (8-12) - 2x','HARD WAYS - 8x','FIELD (3,4,9,10,11) - 2x'];return`<button class="bet-option epic-bet-option" data-bet="${bet}" style="padding:12px;background:linear-gradient(135deg,rgba(255,255,255,0.1),rgba(255,255,255,0.05));border:2px solid rgba(255,255,255,0.2);border-radius:12px;color:var(--sw);font-family:JetBrains Mono,monospace;font-weight:600;cursor:pointer;transition:all 0.3s ease;min-height:60px;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden">${labels[i]}</button>`}).join('');$$('.bet-option').forEach(btn=>{btn.addEventListener('mouseenter',()=>{btn.style.borderColor='var(--pc)';btn.style.transform='translateY(-2px)';btn.style.boxShadow='0 8px 25px rgba(0,229,255,0.2)'});btn.addEventListener('mouseleave',()=>{if(!btn.classList.contains('selected')){btn.style.borderColor='rgba(255,255,255,0.2)';btn.style.transform='translateY(0)';btn.style.boxShadow='none'}});btn.onclick=()=>{this.enhancedVibration(25);this.epicSelBet(btn.dataset.bet)}})}}setupEpicDice(){['dice1','dice2'].forEach(dId=>{const dice=$(dId);if(dice){dice.style.cssText+=';background:linear-gradient(135deg,#000,var(--cp));border:3px solid var(--cg);border-radius:15px;box-shadow:0 0 25px var(--cg),inset 0 0 20px rgba(74,20,140,0.3);transition:all 0.4s ease;position:relative;overflow:hidden';const shine=document.createElement('div');shine.style.cssText='position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent,rgba(255,255,255,0.1),transparent);animation:diceShine 4s ease-in-out infinite;pointer-events:none';dice.appendChild(shine)}for(let f=1;f<=6;f++){const fEl=$(dId)?.querySelector(`.face-${f}`);if(fEl){fEl.innerHTML='';fEl.style.cssText+=';transition:opacity 0.3s ease';for(let i=0;i<f;i++){const dot=document.createElement('div');dot.className='dice-dot epic-dot';dot.style.cssText='width:16px;height:16px;border-radius:50%;background:radial-gradient(circle,#fff 30%,var(--cg) 70%);box-shadow:0 0 12px var(--cg),inset 0 0 5px rgba(255,255,255,0.3);border:2px solid var(--cg);grid-area:1/1;transition:all 0.3s ease';fEl.appendChild(dot)}}}})}resetEpicDice(){const rollBtn=$('rollBtn'),selectedBet=$('selectedBet');rollBtn.disabled=1;rollBtn.style.opacity='0.5';selectedBet.textContent='Choose your cosmic prediction';$$('.bet-option').forEach(btn=>{btn.classList.remove('selected','epic-selected');btn.style.borderColor='rgba(255,255,255,0.2)';btn.style.boxShadow='none';btn.style.transform='translateY(0)'});Object.assign(this.g.d,{v1:1,v2:1});this.showEpicFace('dice1',1);this.showEpicFace('dice2',1);this.epicUpdTot()}epicSelBet(bet){this.g.d.bet=bet;$$('.bet-option').forEach(btn=>{btn.classList.remove('selected','epic-selected');btn.style.borderColor='rgba(255,255,255,0.2)';btn.style.boxShadow='none';btn.style.transform='translateY(0)'});const selectedBtn=document.querySelector(`[data-bet="${bet}"]`);if(selectedBtn){selectedBtn.classList.add('selected','epic-selected');selectedBtn.style.borderColor='var(--wg)';selectedBtn.style.boxShadow='0 0 20px var(--wg)';selectedBtn.style.transform='translateY(-3px)';this.createBetSelectEffect(selectedBtn)}const betNames={low:'LOW NUMBERS (2-6)',seven:'LUCKY SEVEN (7)',high:'HIGH NUMBERS (8-12)',hard:'HARD WAYS',field:'FIELD NUMBERS'};$('selectedBet').textContent=betNames[bet];const rollBtn=$('rollBtn');rollBtn.disabled=0;rollBtn.style.opacity='1';rollBtn.classList.add('btn-ready')}async epicRollDice(){if(!this.g.d.bet||this.g.d.roll)return;const bet=+$('diceBet').value;if(!await this.betWithFeedback(bet,'dice'))return;this.g.d.roll=1;const rollBtn=$('rollBtn');this.load(rollBtn,'ROLLING...',!0);this.createDiceRollEffect();['dice1','dice2'].forEach(dId=>{const dice=$(dId);dice.classList.add('epic-rolling');dice.style.transform='rotateX(720deg) rotateY(720deg)';dice.style.filter='brightness(1.3) saturate(1.2)'});await new Promise(r=>setTimeout(r,1500));this.g.d.v1=Math.floor(Math.random()*6)+1;this.g.d.v2=Math.floor(Math.random()*6)+1;['dice1','dice2'].forEach(dId=>{const dice=$(dId);dice.classList.remove('epic-rolling');dice.style.transform='rotateX(0deg) rotateY(0deg)';dice.style.filter='brightness(1) saturate(1)'});this.showEpicFace('dice1',this.g.d.v1);this.showEpicFace('dice2',this.g.d.v2);this.epicUpdTot();const tot=this.g.d.v1+this.g.d.v2,isHard=this.g.d.v1===this.g.d.v2;this.g.d.hot.unshift(tot);if(this.g.d.hot.length>10)this.g.d.hot.pop();const outcomes={low:()=>tot>=2&&tot<=6?{win:1,mult:2,msg:`LOW WINS! Rolled ${tot}`}:{win:0},high:()=>tot>=8&&tot<=12?{win:1,mult:2,msg:`HIGH WINS! Rolled ${tot}`}:{win:0},seven:()=>tot===7?{win:1,mult:5,msg:'🎯 LUCKY SEVEN! Perfect prediction!'}:{win:0},hard:()=>[4,6,8,10].includes(tot)&&isHard?{win:1,mult:8,msg:`🎲 HARD ${tot}! Perfect doubles!`}:{win:0},field:()=>[3,4,9,10,11].includes(tot)?{win:1,mult:2,msg:`FIELD WINS! Hit ${tot}`}:{win:0}},result=outcomes[this.g.d.bet]();if(result.win){const winAmt=bet*result.mult;await this.winWithCelebration(winAmt,'dice',result.mult>=5?'big':'normal');this.createDiceWinEffect(result.mult);this.showRes('dice',`⭐ ${result.msg} - Won ${this.trimZeros(winAmt.toFixed(8))} ${this.c} (${result.mult}x)`,'win')}else{this.showRes('dice',`🎲 Rolled ${tot} - Cosmic forces say no win on ${this.g.d.bet.toUpperCase()}!`,'lose');this.createDiceLoseEffect()}this.g.d.roll=0;this.unload(rollBtn,'🎲 ROLL DICE');setTimeout(()=>this.resetEpicDice(),2e3)}showEpicFace(dId,val){const dice=$(dId);$$(`#${dId} .dice-face`).forEach(f=>{f.classList.remove('active');f.style.opacity='0'});const activeFace=dice.querySelector(`.face-${val}`);if(activeFace){activeFace.classList.add('active');activeFace.style.opacity='1';activeFace.querySelectorAll('.epic-dot').forEach((dot,i)=>{setTimeout(()=>{dot.style.transform='scale(1.2)';dot.style.boxShadow='0 0 15px var(--cg)';setTimeout(()=>{dot.style.transform='scale(1)';dot.style.boxShadow='0 0 12px var(--cg)'},200)},i*100)})}}epicUpdTot(){const totEl=$('diceTotal'),newTotal=this.g.d.v1+this.g.d.v2;if(totEl){totEl.style.transform='scale(1.4)';totEl.style.color='var(--cg)';totEl.textContent=newTotal;setTimeout(()=>{totEl.style.transform='scale(1)';totEl.style.color=''},600)}}createRollEffect(){for(let i=0;i<6;i++){setTimeout(()=>{const star=document.createElement('div');star.textContent='🎲';star.style.cssText=`position:fixed;top:50%;left:50%;font-size:1.5rem;pointer-events:none;z-index:1002;opacity:1;transition:all 1s ease-out`;document.body.appendChild(star);setTimeout(()=>{const angle=i*60;star.style.transform=`translate(-50%,-50%) rotate(${angle}deg) translateY(-50px) scale(0.5)`;star.style.opacity='0';setTimeout(()=>star.remove(),1e3)},100)},i*80)}}createDiceRollEffect(){this.createBurst(10);const roll=document.createElement('div');roll.textContent='🎲 COSMIC DICE SPINNING';roll.style.cssText=`position:fixed;top:30%;left:50%;transform:translate(-50%,-50%);font-size:1.5rem;color:var(--pc);font-family:JetBrains Mono,monospace;font-weight:700;pointer-events:none;z-index:1002;opacity:1;transition:all 1.5s ease-out;text-shadow:0 0 15px var(--pc)`;document.body.appendChild(roll);setTimeout(()=>{roll.style.opacity='0';roll.style.transform='translate(-50%,-50%) translateY(-80px)';setTimeout(()=>roll.remove(),1500)},500)}createBetSelectEffect(btn){const rect=btn.getBoundingClientRect();for(let i=0;i<3;i++){setTimeout(()=>{const sparkle=document.createElement('div');sparkle.style.cssText=`position:fixed;top:${rect.top+rect.height/2}px;left:${rect.left+rect.width/2}px;width:4px;height:4px;background:var(--wg);border-radius:50%;pointer-events:none;z-index:1002;opacity:1;transition:all 0.8s ease-out;box-shadow:0 0 10px var(--wg)`;document.body.appendChild(sparkle);setTimeout(()=>{const angle=i*120;sparkle.style.transform=`translate(-50%,-50%) rotate(${angle}deg) translateY(-30px) scale(2)`;sparkle.style.opacity='0';setTimeout(()=>sparkle.remove(),800)},100)},i*100)}}createDiceWinEffect(multiplier){['dice1','dice2'].forEach(dId=>{const dice=$(dId);dice.style.boxShadow='0 0 40px var(--cg),inset 0 0 30px rgba(255,215,0,0.3)';dice.style.transform='scale(1.1)';setTimeout(()=>{dice.style.boxShadow='0 0 25px var(--cg),inset 0 0 20px rgba(74,20,140,0.3)';dice.style.transform='scale(1)'},1500)});if(multiplier>=5){for(let i=0;i<8;i++){setTimeout(()=>{const firework=document.createElement('div');firework.textContent='🎆';firework.style.cssText=`position:fixed;top:${30+Math.random()*40}%;left:${20+Math.random()*60}%;font-size:2rem;pointer-events:none;z-index:1003;opacity:1;transition:all 2s ease-out`;document.body.appendChild(firework);setTimeout(()=>{firework.style.transform='scale(2) rotate(360deg)';firework.style.opacity='0';setTimeout(()=>firework.remove(),2e3)},200)},i*150)}}}createDiceLoseEffect(){['dice1','dice2'].forEach(dId=>{const dice=$(dId);dice.style.filter='brightness(0.6) saturate(0.4)';setTimeout(()=>dice.style.filter='brightness(1) saturate(1)',1e3)})}setupGames(){}

enhancedVibration(pattern) {
    if (Array.isArray(pattern)) {
        pattern.forEach((duration, index) => {
            setTimeout(() => this.vib(duration), index * 100);
        });
    } else {
        this.vib(pattern);
    }
}

async betWithFeedback(amt, game) {
    const betBtn = $(`${game}Bet`).parentElement.querySelector('.cosmic-btn');
    if (betBtn) {
        betBtn.classList.add('bet-processing');
        this.load(betBtn, 'Betting...', true);
    }
    const result = await this.deduct(amt);
    if (betBtn) {
        this.unload(betBtn, betBtn.textContent);
        betBtn.classList.remove('bet-processing');
    }
    if (result) {
        this.createBetEffect(amt, game);
    }
    return result;
}

createBetEffect(amt, game) {
    const effect = document.createElement('div');
    effect.textContent = `-${this.trimZeros(amt.toFixed(this.c === 'AMINA' ? 8 : 0))} ${this.c}`;
    effect.style.cssText = `position:fixed;top:25%;right:15%;color:#FF6B35;font-family:JetBrains Mono,monospace;font-weight:700;font-size:1.1rem;pointer-events:none;z-index:1001;opacity:1;transition:all 1.2s cubic-bezier(0.25,0.46,0.45,0.94);text-shadow:0 0 10px #FF6B35;border:2px solid #FF6B35;padding:5px 10px;border-radius:8px;background:rgba(255,107,53,0.1)`;
    document.body.appendChild(effect);
    setTimeout(() => {
        effect.style.transform = 'translateY(-60px) scale(0.8)';
        effect.style.opacity = '0';
        setTimeout(() => effect.remove(), 1200);
    }, 100);
}

async winWithCelebration(amt, game, type = 'normal') {
    await this.add(amt, 'win');
    this.createWinCelebration(amt, type);
    if (type === 'mega') {
        this.createMegaWinSpectacle();
    } else if (type === 'big') {
        this.createBigWinShow();
    }
}

createWinCelebration(amt, type = 'normal') {
    const colors = ['#4CAF50', '#FFD700', '#00E5FF', '#E91E63'];
    const celebration = document.createElement('div');
    celebration.textContent = `+${this.trimZeros(amt.toFixed(this.c === 'AMINA' ? 8 : 0))} ${this.c}`;
    celebration.style.cssText = `position:fixed;top:25%;right:15%;color:${colors[Math.floor(Math.random() * colors.length)]};font-family:JetBrains Mono,monospace;font-weight:700;font-size:${type === 'mega' ? '2rem' : type === 'big' ? '1.6rem' : '1.3rem'};pointer-events:none;z-index:1001;opacity:1;transition:all 1.5s cubic-bezier(0.175,0.885,0.32,1.275);text-shadow:0 0 15px currentColor;border:3px solid currentColor;padding:8px 15px;border-radius:12px;background:rgba(255,255,255,0.1);backdrop-filter:blur(5px)`;
    document.body.appendChild(celebration);
    setTimeout(() => {
        celebration.style.transform = `translateY(-80px) scale(${type === 'mega' ? '1.5' : type === 'big' ? '1.3' : '1.1'})`;
        celebration.style.opacity = '0';
        setTimeout(() => celebration.remove(), 1500);
    }, 100);
}

createBigWinShow() {
    this.createBurst(20);
    for (let i = 0; i < 8; i++) {
        setTimeout(() => {
            const firework = document.createElement('div');
            firework.style.cssText = `position:fixed;top:${20 + Math.random() * 60}%;left:${10 + Math.random() * 80}%;width:5px;height:5px;background:hsl(${Math.random() * 360},70%,60%);border-radius:50%;pointer-events:none;z-index:1002;opacity:1;transition:all 1.5s ease-out;box-shadow:0 0 20px currentColor`;
            document.body.appendChild(firework);
            setTimeout(() => {
                firework.style.transform = `scale(8) rotate(360deg)`;
                firework.style.opacity = '0';
                setTimeout(() => firework.remove(), 1500);
            }, 100);
        }, i * 150);
    }
}

createMegaWinSpectacle() {
    this.createBurst(40);
    this.createStarBurst();
    for (let i = 0; i < 15; i++) {
        setTimeout(() => {
            const spectacular = document.createElement('div');
            spectacular.textContent = ['🌟', '⭐', '✨', '💫', '🎆'][Math.floor(Math.random() * 5)];
            spectacular.style.cssText = `position:fixed;top:${Math.random() * 100}%;left:${Math.random() * 100}%;font-size:${2 + Math.random() * 2}rem;pointer-events:none;z-index:1003;opacity:1;transition:all 2s ease-out;filter:drop-shadow(0 0 10px gold)`;
            document.body.appendChild(spectacular);
            setTimeout(() => {
                spectacular.style.transform = `scale(${2 + Math.random()}) rotate(${360 + Math.random() * 360}deg) translateY(-100px)`;
                spectacular.style.opacity = '0';
                setTimeout(() => spectacular.remove(), 2000);
            }, 100);
        }, i * 80);
    }
}

createBurst(count) {
    for (let i = 0; i < count; i++) {
        setTimeout(() => {
            const burst = document.createElement('div');
            burst.className = 'cosmic-burst';
            burst.style.cssText = `position:fixed;top:${Math.random() * 100}%;left:${Math.random() * 100}%;width:3px;height:3px;background:hsl(${Math.random() * 360},70%,60%);border-radius:50%;pointer-events:none;z-index:999;opacity:1;transition:all 1s ease-out`;
            document.body.appendChild(burst);
            setTimeout(() => {
                burst.style.transform = `scale(${2 + Math.random() * 3}) translateY(-${50 + Math.random() * 100}px)`;
                burst.style.opacity = '0';
                setTimeout(() => burst.remove(), 1000);
            }, 100);
        }, i * 100);
    }
}

createStarBurst() {
    for (let i = 0; i < 8; i++) {
        const star = document.createElement('div');
        star.className = 'star-burst';
        star.style.cssText = `position:fixed;top:50%;left:50%;width:4px;height:4px;background:#FFD700;border-radius:50%;pointer-events:none;z-index:1000;transform:translate(-50%,-50%) rotate(${i * 45}deg) translateY(-${20 + Math.random() * 30}px);opacity:1;transition:all 0.8s ease-out`;
        document.body.appendChild(star);
        setTimeout(() => {
            star.style.transform += ` translateY(-${100 + Math.random() * 50}px) scale(0)`;
            star.style.opacity = '0';
            setTimeout(() => star.remove(), 800);
        }, 50);
    }
}

silkyRestore() {
    this.sil = true;
    const ch = localStorage.getItem('cached_amina_balance') || sessionStorage.getItem('cached_amina_balance');
    if (ch && this.w) this.b.AMINA = parseFloat(ch);
    if (this.w) {
        this.c = 'AMINA';
        this.epicUpdCur();
        this.updBets();
        this.updDisp();
    } else {
        this.c = 'HC';
        this.epicUpdCur();
        this.updBets();
        this.updDisp();
    }
    this.sil = false;
}

async epicCheck() {
    if (this.dp) return;
    if (this.w) {
        const tg = $('currencyToggle');
        if (tg) {
            tg.classList.add('wallet-connected');
            setTimeout(() => tg.classList.remove('wallet-connected'), 1000);
        }
        this.updWal();
        const ap = localStorage.getItem('app_state') || sessionStorage.getItem('app_state');
        if (ap) {
            const st = JSON.parse(ap);
            if (st.inCasino && st.timestamp > Date.now() - 300000) {
                setTimeout(() => this.enter(), 100);
            }
        }
        this.loadGameState();
        this.silkySync();
        setTimeout(() => this.refWal(), 300);
        this.processSyncQueue();
    }
}

epicUpdCur() {
    const tg = $('currencyToggle'), tx = tg?.querySelector('.currency-text');
    if (this.c === 'AMINA') {
        tg?.classList.add('amina');
        if (tx) {
            tx.textContent = 'AMINA';
            tx.classList.add('currency-shine');
            setTimeout(() => tx.classList.remove('currency-shine'), 800);
        }
    } else {
        tg?.classList.remove('amina');
        if (tx) {
            tx.textContent = 'HC';
            tx.classList.add('currency-shine');
            setTimeout(() => tx.classList.remove('currency-shine'), 800);
        }
    }
}

silentForceAMINA() {
    if (this.w && this.cc >= 0.001 && this.c === 'HC') {
        this.c = 'AMINA';
        this.epicUpdCur();
        this.epicUpdBets();
        this.updDisp();
        this.saveApp();
        this.createGentleGlow();
    }
}

epicUpdBets() {
    const bets = this.c === 'HC' ? ['1', '5', '10'] : ['0.001', '0.005', '0.01'];
    ['slots', 'plinko', 'blackjack', 'hilo', 'dice'].forEach(g => {
        const sel = $(`${g}Bet`);
        if (sel) {
            const oldVal = sel.value;
            sel.innerHTML = '';
            bets.forEach(b => {
                const opt = document.createElement('option');
                opt.value = opt.textContent = b;
                sel.appendChild(opt);
            });
            sel.value = bets.includes(oldVal) ? oldVal : bets[0];
            sel.classList.add('bet-update');
            setTimeout(() => sel.classList.remove('bet-update'), 400);
        }
    });
}

silkySync() {
    return this.sync();
}

epicForceAMINA() {
    if (this.w && this.cc < 0.001) {
        if (!this.sil) this.notify('❌ Need at least 0.001 AMINA to switch. Visit Cashier!');
        this.forceHC();
        return false;
    }
    if (!this.w) {
        this.forceHC();
        return false;
    }
    this.c = 'AMINA';
    this.epicUpdCur();
    this.epicUpdBets();
    this.updDisp();
    this.saveApp();
    this.createRippleEffect('AMINA');
    return true;
}

createRippleEffect(type) {
    const color = type === 'AMINA' ? '255,20,147' : '0,229,255';
    const ripple = document.createElement('div');
    ripple.style.cssText = `position:fixed;top:50%;left:50%;width:0;height:0;border-radius:50%;background:rgba(${color},0.2);border:2px solid rgba(${color},0.8);pointer-events:none;z-index:1000;transition:all 0.8s ease-out;transform:translate(-50%,-50%)`;
    document.body.appendChild(ripple);
    setTimeout(() => {
        ripple.style.width = '200px';
        ripple.style.height = '200px';
        ripple.style.opacity = '0';
        setTimeout(() => ripple.remove(), 800);
    }, 10);
}

createGentleGlow() {
    const glow = document.createElement('div');
    glow.style.cssText = `position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle,rgba(255,215,0,0.05),transparent 70%);pointer-events:none;z-index:998;opacity:0;transition:opacity 1s ease`;
    document.body.appendChild(glow);
    setTimeout(() => {
        glow.style.opacity = '1';
        setTimeout(() => {
            glow.style.opacity = '0';
            setTimeout(() => glow.remove(), 1000);
        }, 1000);
    }, 10);
}

createWarningPulse() {
    const pulse = document.createElement('div');
    pulse.style.cssText = `position:fixed;top:50%;left:50%;width:50px;height:50px;border:3px solid #F44336;border-radius:50%;pointer-events:none;z-index:1000;opacity:1;transition:all 0.8s ease-out;transform:translate(-50%,-50%)`;
    document.body.appendChild(pulse);
    setTimeout(() => {
        pulse.style.width = '150px';
        pulse.style.height = '150px';
        pulse.style.opacity = '0';
        setTimeout(() => pulse.remove(), 800);
    }, 10);
}

createErrorShake() {
    const el = $('balanceAmount');
    if (el) {
        el.classList.add('error-shake');
        setTimeout(() => el.classList.remove('error-shake'), 600);
    }
}

createSpendEffect(amt) {
    const spend = document.createElement('div');
    spend.textContent = `-${this.trimZeros(amt.toFixed(this.c === 'AMINA' ? 8 : 0))} ${this.c}`;
    spend.style.cssText = `position:fixed;top:30%;right:20%;color:#F44336;font-family:JetBrains Mono,monospace;font-weight:700;font-size:1.2rem;pointer-events:none;z-index:1001;opacity:1;transition:all 1s ease-out`;
    document.body.appendChild(spend);
    setTimeout(() => {
        spend.style.transform = 'translateY(-50px)';
        spend.style.opacity = '0';
        setTimeout(() => spend.remove(), 1000);
    }, 100);
}

createWinEffect(amt) {
    const win = document.createElement('div');
    win.textContent = `+${this.trimZeros(amt.toFixed(this.c === 'AMINA' ? 8 : 0))} ${this.c}`;
    win.style.cssText = `position:fixed;top:30%;right:20%;color:#4CAF50;font-family:JetBrains Mono,monospace;font-weight:700;font-size:1.4rem;pointer-events:none;z-index:1001;opacity:1;transition:all 1s ease-out;text-shadow:0 0 10px #4CAF50`;
    document.body.appendChild(win);
    setTimeout(() => {
        win.style.transform = 'translateY(-50px) scale(1.2)';
        win.style.opacity = '0';
        setTimeout(() => win.remove(), 1000);
    }, 100);
}

createWinBurst() {
    this.createBurst(5);
}

createMegaWinExplosion() {
    this.createBurst(15);
    this.createStarBurst();
}

createRipple(el) {
    const rect = el.getBoundingClientRect();
    const ripple = document.createElement('div');
    ripple.style.cssText = `position:fixed;top:${rect.top + rect.height/2}px;left:${rect.left + rect.width/2}px;width:0;height:0;border-radius:50%;background:rgba(255,215,0,0.3);pointer-events:none;z-index:1000;transition:all 0.6s ease-out;transform:translate(-50%,-50%)`;
    document.body.appendChild(ripple);
    setTimeout(() => {
        ripple.style.width = '100px';
        ripple.style.height = '100px';
        ripple.style.opacity = '0';
        setTimeout(() => ripple.remove(), 600);
    }, 10);
}

createSparkle(el) {
    const rect = el.getBoundingClientRect();
    for (let i = 0; i < 3; i++) {
        const sparkle = document.createElement('div');
        sparkle.style.cssText = `position:fixed;top:${rect.top + Math.random() * rect.height}px;left:${rect.left + Math.random() * rect.width}px;width:2px;height:2px;background:#FFD700;border-radius:50%;pointer-events:none;z-index:1001;opacity:1;transition:all 0.8s ease-out`;
        document.body.appendChild(sparkle);
        setTimeout(() => {
            sparkle.style.transform = `translateY(-${30 + Math.random() * 20}px) scale(0)`;
            sparkle.style.opacity = '0';
            setTimeout(() => sparkle.remove(), 800);
        }, i * 100);
    }
}

createCurrencyWave(type) {
    const wave = document.createElement('div');
    wave.style.cssText = `position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(${type === 'AMINA' ? '255,20,147' : '0,229,255'},0.1),transparent);pointer-events:none;z-index:999;opacity:0;transition:all 0.6s ease;transform:translateX(-100%)`;
    document.body.appendChild(wave);
    setTimeout(() => {
        wave.style.opacity = '1';
        wave.style.transform = 'translateX(100%)';
        setTimeout(() => wave.remove(), 600);
    }, 10);
}

}

function $(id) {
    return document.getElementById(id);
}

function $$(sel) {
    return document.querySelectorAll(sel);
}

function openAminaExplorer() {
    window.open('https://explorer.perawallet.app/asset/1107424865/', '_blank');
}

function showDonationModal() {
    $('donationModal').style.display = 'flex';
}

function closeDonationModal() {
    $('donationModal').style.display = 'none';
}

function copyDonationAddress() {
    const input = $('donationWallet');
    input.select();
    document.execCommand('copy');
    alert('Address copied! 🚀');
}

let casino;
document.addEventListener('DOMContentLoaded', () => {
    casino = new AminaCasino();
});
window.casino = casino;